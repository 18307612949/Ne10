<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Project Ne10: /home/philwong/Ne10-gerrit/modules/dsp/NE10_rfft_float32.neonintrinsic.c Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="ne10_logo.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Project Ne10
   
   </div>
   <div id="projectbrief">An Open Optimized Software Library Project for the ARM Architecture</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">/home/philwong/Ne10-gerrit/modules/dsp/NE10_rfft_float32.neonintrinsic.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  Copyright 2014 ARM Limited and Contributors.</span>
<a name="l00003"></a>00003 <span class="comment"> *  All rights reserved.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> *  modification, are permitted provided that the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment"> *    * Redistributions of source code must retain the above copyright</span>
<a name="l00008"></a>00008 <span class="comment"> *      notice, this list of conditions and the following disclaimer.</span>
<a name="l00009"></a>00009 <span class="comment"> *    * Redistributions in binary form must reproduce the above copyright</span>
<a name="l00010"></a>00010 <span class="comment"> *      notice, this list of conditions and the following disclaimer in the</span>
<a name="l00011"></a>00011 <span class="comment"> *      documentation and/or other materials provided with the distribution.</span>
<a name="l00012"></a>00012 <span class="comment"> *    * Neither the name of ARM Limited nor the</span>
<a name="l00013"></a>00013 <span class="comment"> *      names of its contributors may be used to endorse or promote products</span>
<a name="l00014"></a>00014 <span class="comment"> *      derived from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> *  THIS SOFTWARE IS PROVIDED BY ARM LIMITED AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00017"></a>00017 <span class="comment"> *  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00018"></a>00018 <span class="comment"> *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<a name="l00019"></a>00019 <span class="comment"> *  DISCLAIMED. IN NO EVENT SHALL ARM LIMITED AND CONTRIBUTORS BE LIABLE FOR ANY</span>
<a name="l00020"></a>00020 <span class="comment"> *  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00021"></a>00021 <span class="comment"> *  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00022"></a>00022 <span class="comment"> *  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND</span>
<a name="l00023"></a>00023 <span class="comment"> *  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00024"></a>00024 <span class="comment"> *  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00025"></a>00025 <span class="comment"> *  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="comment">/* license of Kiss FFT */</span>
<a name="l00029"></a>00029 <span class="comment">/*</span>
<a name="l00030"></a>00030 <span class="comment">Copyright (c) 2003-2010, Mark Borgerding</span>
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">All rights reserved.</span>
<a name="l00033"></a>00033 <span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00035"></a>00035 <span class="comment"></span>
<a name="l00036"></a>00036 <span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00037"></a>00037 <span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00038"></a>00038 <span class="comment">    * Neither the author nor the names of any contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00039"></a>00039 <span class="comment"></span>
<a name="l00040"></a>00040 <span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00041"></a>00041 <span class="comment">*/</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="comment">/*</span>
<a name="l00044"></a>00044 <span class="comment"> * NE10 Library : dsp/NE10_rfft_float32.neonintrinsic.c</span>
<a name="l00045"></a>00045 <span class="comment"> */</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="preprocessor">#include &lt;arm_neon.h&gt;</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;NE10_types.h&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;NE10_macros.h&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;NE10_fft.h&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;NE10_dsp.h&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;NE10_fft.neonintrinsic.h&quot;</span>
<a name="l00054"></a>00054 
<a name="l00055"></a>00055 NE10_INLINE <span class="keywordtype">void</span> ne10_radix8x4_r2c_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00056"></a>00056                                   <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00057"></a>00057                                   <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00058"></a>00058                                   <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00059"></a>00059                                   <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061     ne10_int32_t f_count;
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     NE10_DECLARE_8(float32x4_t,q_in);
<a name="l00064"></a>00064     NE10_DECLARE_8(float32x4_t,q_out);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;  <span class="comment">// 8 x fstride</span>
<a name="l00067"></a>00067           float32x4_t *Fout_neon = (float32x4_t*) Fout; <span class="comment">// fstride x 8</span>
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     <span class="keywordflow">for</span> (f_count = fstride; f_count &gt; 0; f_count --)
<a name="l00070"></a>00070     {
<a name="l00071"></a>00071         <span class="comment">// from Fin_neon load 8 float32x4_t into q_in0 ~ q_in7, by step = fstride</span>
<a name="l00072"></a>00072         NE10_RADIX8x4_R2C_NEON_LOAD(Fin_neon,q_in,fstride);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="comment">// print q_in0 ~ q_in7</span>
<a name="l00075"></a>00075         <span class="comment">// NE10_PRINT_Qx8_VECTOR(q_in);</span>
<a name="l00076"></a>00076 
<a name="l00077"></a>00077         <span class="comment">// do r2c fft, size = 8</span>
<a name="l00078"></a>00078         NE10_RADIX8x4_R2C_NEON_KERNEL(q_out,q_in);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <span class="comment">// print q_out0 ~ q_out7</span>
<a name="l00081"></a>00081         <span class="comment">// NE10_PRINT_Qx8_VECTOR(q_out);</span>
<a name="l00082"></a>00082 
<a name="l00083"></a>00083         <span class="comment">// store q_out0 ~ q_out7 to Fout_neon, by step = 1</span>
<a name="l00084"></a>00084         NE10_RADIX8x4_R2C_NEON_STORE(Fout_neon,q_out,1);
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         Fin_neon = Fin_neon - fstride * 8 + 1;
<a name="l00087"></a>00087         Fout_neon += 8; <span class="comment">// next column</span>
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 }
<a name="l00090"></a>00090 
<a name="l00091"></a>00091 NE10_INLINE <span class="keywordtype">void</span> ne10_radix8x4_c2r_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00092"></a>00092                                   <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00093"></a>00093                                   <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00094"></a>00094                                   <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00095"></a>00095                                   <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097     ne10_int32_t f_count;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     NE10_DECLARE_8(float32x4_t,q_in);
<a name="l00100"></a>00100     NE10_DECLARE_8(float32x4_t,q_out);
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <span class="keyword">const</span> ne10_float32_t one_by_N = 0.25 / nfft;
<a name="l00103"></a>00103     <span class="keyword">const</span> float32x4_t one_by_N_neon = vdupq_n_f32(one_by_N);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;
<a name="l00106"></a>00106           float32x4_t *Fout_neon = (float32x4_t*) Fout;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <span class="keywordflow">for</span> (f_count = fstride; f_count &gt; 0; f_count --)
<a name="l00109"></a>00109     {
<a name="l00110"></a>00110         <span class="comment">// from Fin_neon load 8 float32x4_t into q_in0 ~ q_in7, by step = 1</span>
<a name="l00111"></a>00111         NE10_RADIX8x4_R2C_NEON_LOAD(Fin_neon,q_in,1);
<a name="l00112"></a>00112 
<a name="l00113"></a>00113         <span class="comment">// NE10_PRINT_Qx8_VECTOR(q_in);</span>
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         NE10_RADIX8x4_C2R_NEON_KERNEL(q_out,q_in);
<a name="l00116"></a>00116 
<a name="l00117"></a>00117         <span class="comment">// NE10_PRINT_Qx8_VECTOR(q_out);</span>
<a name="l00118"></a>00118 
<a name="l00119"></a>00119 <span class="preprocessor">#ifdef NE10_DSP_RFFT_SCALING</span>
<a name="l00120"></a>00120 <span class="preprocessor"></span>        q_out0 = vmulq_f32(q_out0,one_by_N_neon);
<a name="l00121"></a>00121         q_out1 = vmulq_f32(q_out1,one_by_N_neon);
<a name="l00122"></a>00122         q_out2 = vmulq_f32(q_out2,one_by_N_neon);
<a name="l00123"></a>00123         q_out3 = vmulq_f32(q_out3,one_by_N_neon);
<a name="l00124"></a>00124         q_out4 = vmulq_f32(q_out4,one_by_N_neon);
<a name="l00125"></a>00125         q_out5 = vmulq_f32(q_out5,one_by_N_neon);
<a name="l00126"></a>00126         q_out6 = vmulq_f32(q_out6,one_by_N_neon);
<a name="l00127"></a>00127         q_out7 = vmulq_f32(q_out7,one_by_N_neon);
<a name="l00128"></a>00128 <span class="preprocessor">#endif</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00130"></a>00130         <span class="comment">// store</span>
<a name="l00131"></a>00131         NE10_RADIX8x4_R2C_NEON_STORE(Fout_neon,q_out,fstride);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         Fout_neon ++;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135 }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_r2c_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00138"></a>00138                                   <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00139"></a>00139                                   <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00140"></a>00140                                   <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00141"></a>00141                                   <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00142"></a>00142 {
<a name="l00143"></a>00143     ne10_int32_t f_count;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;
<a name="l00146"></a>00146           float32x4_t *Fout_neon = (float32x4_t*) Fout;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00149"></a>00149     {
<a name="l00150"></a>00150         NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00151"></a>00151         NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00152"></a>00152 
<a name="l00153"></a>00153         <span class="comment">// load</span>
<a name="l00154"></a>00154         NE10_RADIX4x4_R2C_NEON_LOAD(Fin_neon,q_in,fstride);
<a name="l00155"></a>00155 
<a name="l00156"></a>00156         NE10_RADIX4x4_R2C_NEON_KERNEL(q_out,q_in)
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="comment">// store</span>
<a name="l00159"></a>00159         NE10_RADIX4x4_R2C_NEON_STORE(Fout_neon,q_out,1);
<a name="l00160"></a>00160 
<a name="l00161"></a>00161         Fin_neon = Fin_neon - 4*fstride + 1;
<a name="l00162"></a>00162         Fout_neon += 4;
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164 }
<a name="l00165"></a>00165 
<a name="l00166"></a>00166 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_c2r_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00167"></a>00167                                   const <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00168"></a>00168                                   const ne10_int32_t fstride,
<a name="l00169"></a>00169                                   const ne10_int32_t mstride,
<a name="l00170"></a>00170                                   const ne10_int32_t nfft)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172     ne10_int32_t f_count;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;
<a name="l00175"></a>00175           float32x4_t *Fout_neon = (float32x4_t*) Fout;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177     <span class="keyword">const</span> ne10_float32_t one_by_N = 0.25 / nfft;
<a name="l00178"></a>00178     <span class="keyword">const</span> float32x4_t one_by_N_neon = vdupq_n_f32(one_by_N);
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="keywordflow">for</span> (f_count = 0; f_count &lt; fstride; f_count ++)
<a name="l00181"></a>00181     {
<a name="l00182"></a>00182         NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00183"></a>00183         NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         <span class="comment">// load</span>
<a name="l00186"></a>00186         NE10_RADIX4x4_R2C_NEON_LOAD(Fin_neon,q_in,1);
<a name="l00187"></a>00187 
<a name="l00188"></a>00188         <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_in);</span>
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         NE10_RADIX4x4_C2R_NEON_KERNEL(q_out,q_in)
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_out);</span>
<a name="l00193"></a>00193 
<a name="l00194"></a>00194 <span class="preprocessor">#ifdef NE10_DSP_RFFT_SCALING</span>
<a name="l00195"></a>00195 <span class="preprocessor"></span>        q_out0 = vmulq_f32(q_out0,one_by_N_neon);
<a name="l00196"></a>00196         q_out1 = vmulq_f32(q_out1,one_by_N_neon);
<a name="l00197"></a>00197         q_out2 = vmulq_f32(q_out2,one_by_N_neon);
<a name="l00198"></a>00198         q_out3 = vmulq_f32(q_out3,one_by_N_neon);
<a name="l00199"></a>00199 <span class="preprocessor">#endif</span>
<a name="l00200"></a>00200 <span class="preprocessor"></span>
<a name="l00201"></a>00201         <span class="comment">// store</span>
<a name="l00202"></a>00202         NE10_RADIX4x4_R2C_NEON_STORE(Fout_neon,q_out,fstride);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         Fout_neon ++;
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_r2c_with_twiddles_first_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00209"></a>00209                                                             <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00210"></a>00210                                                             <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00211"></a>00211                                                             <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00212"></a>00212                                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00213"></a>00213 {
<a name="l00214"></a>00214     NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00215"></a>00215     NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00216"></a>00216 
<a name="l00217"></a>00217     <span class="comment">// load</span>
<a name="l00218"></a>00218     NE10_RADIX4x4_R2C_NEON_LOAD(Fin_neon,q_in,in_step);
<a name="l00219"></a>00219 
<a name="l00220"></a>00220     NE10_RADIX4x4_R2C_NEON_KERNEL(q_out,q_in);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="comment">// store</span>
<a name="l00223"></a>00223     vst1q_f32( (ne10_float32_t*) (Fout_neon                          ), q_out0);
<a name="l00224"></a>00224     vst1q_f32( (ne10_float32_t*) (Fout_neon +     (out_step &lt;&lt; 1) - 1), q_out1);
<a name="l00225"></a>00225     vst1q_f32( (ne10_float32_t*) (Fout_neon +     (out_step &lt;&lt; 1)    ), q_out2);
<a name="l00226"></a>00226     vst1q_f32( (ne10_float32_t*) (Fout_neon + 2 * (out_step &lt;&lt; 1) - 1), q_out3);
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_c2r_with_twiddles_first_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00230"></a>00230                                                             <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00231"></a>00231                                                             <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00232"></a>00232                                                             <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00233"></a>00233                                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00234"></a>00234 {
<a name="l00235"></a>00235     NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00236"></a>00236     NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00237"></a>00237 
<a name="l00238"></a>00238     <span class="comment">// load</span>
<a name="l00239"></a>00239     q_in0 = vld1q_f32( (ne10_float32_t*) (Fin_neon                          ) );
<a name="l00240"></a>00240     q_in1 = vld1q_f32( (ne10_float32_t*) (Fin_neon +     (out_step &lt;&lt; 1) - 1) );
<a name="l00241"></a>00241     q_in2 = vld1q_f32( (ne10_float32_t*) (Fin_neon +     (out_step &lt;&lt; 1)    ) );
<a name="l00242"></a>00242     q_in3 = vld1q_f32( (ne10_float32_t*) (Fin_neon + 2 * (out_step &lt;&lt; 1) - 1) );
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_in);</span>
<a name="l00245"></a>00245 
<a name="l00246"></a>00246     NE10_RADIX4x4_C2R_NEON_KERNEL(q_out,q_in);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_out);</span>
<a name="l00249"></a>00249 
<a name="l00250"></a>00250     <span class="comment">// store</span>
<a name="l00251"></a>00251     NE10_RADIX4x4_R2C_NEON_STORE(Fout_neon,q_out,in_step);
<a name="l00252"></a>00252 }
<a name="l00253"></a>00253 
<a name="l00254"></a>00254 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_r2c_with_twiddles_other_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00255"></a>00255                                                                 <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00256"></a>00256                                                                 <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00257"></a>00257                                                                 <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00258"></a>00258                                                                 <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00259"></a>00259 {
<a name="l00260"></a>00260     ne10_int32_t m_count;
<a name="l00261"></a>00261     ne10_int32_t loop_count = (out_step&gt;&gt;1) -1;
<a name="l00262"></a>00262     float32x4_t *Fout_b = Fout_neon + (((out_step&lt;&lt;1)-1)&lt;&lt;1) - 2; <span class="comment">// reversed</span>
<a name="l00263"></a>00263 
<a name="l00264"></a>00264     NE10_DECLARE_3(float32x4x2_t,q2_tw);
<a name="l00265"></a>00265     NE10_DECLARE_4(float32x4x2_t,q2_in);
<a name="l00266"></a>00266     NE10_DECLARE_4(float32x4x2_t,q2_out);
<a name="l00267"></a>00267 
<a name="l00268"></a>00268     <span class="keywordflow">for</span> (m_count = loop_count; m_count &gt; 0; m_count -- )
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270         <span class="comment">// load</span>
<a name="l00271"></a>00271         q2_in0.val[0] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 0*in_step    ) );
<a name="l00272"></a>00272         q2_in0.val[1] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 0*in_step + 1) );
<a name="l00273"></a>00273 
<a name="l00274"></a>00274         q2_in1.val[0] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 1*in_step    ) );
<a name="l00275"></a>00275         q2_in1.val[1] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 1*in_step + 1) );
<a name="l00276"></a>00276 
<a name="l00277"></a>00277         q2_in2.val[0] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 2*in_step    ) );
<a name="l00278"></a>00278         q2_in2.val[1] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 2*in_step + 1) );
<a name="l00279"></a>00279 
<a name="l00280"></a>00280         q2_in3.val[0] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 3*in_step    ) );
<a name="l00281"></a>00281         q2_in3.val[1] = vld1q_f32( (ne10_float32_t*) (Fin_neon + 3*in_step + 1) );
<a name="l00282"></a>00282 
<a name="l00283"></a>00283         q2_tw0.val[0] = vdupq_n_f32(twiddles[0].r);
<a name="l00284"></a>00284         q2_tw0.val[1] = vdupq_n_f32(twiddles[0].i);
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         q2_tw1.val[0] = vdupq_n_f32(twiddles[out_step].r);
<a name="l00287"></a>00287         q2_tw1.val[1] = vdupq_n_f32(twiddles[out_step].i);
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         q2_tw2.val[0] = vdupq_n_f32(twiddles[out_step*2].r);
<a name="l00290"></a>00290         q2_tw2.val[1] = vdupq_n_f32(twiddles[out_step*2].i);
<a name="l00291"></a>00291 
<a name="l00292"></a>00292         <span class="comment">// R2C TW KERNEL</span>
<a name="l00293"></a>00293         NE10_RADIX4x4_R2C_TW_NEON_KERNEL(q2_out,q2_in,q2_tw);
<a name="l00294"></a>00294 
<a name="l00295"></a>00295         <span class="comment">// store</span>
<a name="l00296"></a>00296         vst1q_f32( (ne10_float32_t*) ( Fout_neon                      ), q2_out0.val[0] );
<a name="l00297"></a>00297         vst1q_f32( (ne10_float32_t*) ( Fout_neon                   + 1), q2_out0.val[1] );
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         vst1q_f32( (ne10_float32_t*) ( Fout_neon + (out_step &lt;&lt; 1)    ), q2_out1.val[0] );
<a name="l00300"></a>00300         vst1q_f32( (ne10_float32_t*) ( Fout_neon + (out_step &lt;&lt; 1) + 1), q2_out1.val[1] );
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         vst1q_f32( (ne10_float32_t*) ( Fout_b                         ), q2_out2.val[0] );
<a name="l00303"></a>00303         vst1q_f32( (ne10_float32_t*) ( Fout_b                      + 1), q2_out2.val[1] );
<a name="l00304"></a>00304 
<a name="l00305"></a>00305         vst1q_f32( (ne10_float32_t*) ( Fout_b    - (out_step &lt;&lt; 1)    ), q2_out3.val[0] );
<a name="l00306"></a>00306         vst1q_f32( (ne10_float32_t*) ( Fout_b    - (out_step &lt;&lt; 1) + 1), q2_out3.val[1] );
<a name="l00307"></a>00307 
<a name="l00308"></a>00308         <span class="comment">// update pointers</span>
<a name="l00309"></a>00309         Fin_neon  += 2;
<a name="l00310"></a>00310         Fout_neon += 2;
<a name="l00311"></a>00311         Fout_b    -= 2;
<a name="l00312"></a>00312         twiddles ++;
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_c2r_with_twiddles_other_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00317"></a>00317                                                                 <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00318"></a>00318                                                                 <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00319"></a>00319                                                                 <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00320"></a>00320                                                                 <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00321"></a>00321 {
<a name="l00322"></a>00322     ne10_int32_t m_count;
<a name="l00323"></a>00323     ne10_int32_t loop_count = (out_step&gt;&gt;1) -1;
<a name="l00324"></a>00324     <span class="keyword">const</span> float32x4_t *Fin_b = Fin_neon + (((out_step&lt;&lt;1)-1)&lt;&lt;1) - 2; <span class="comment">// reversed</span>
<a name="l00325"></a>00325 
<a name="l00326"></a>00326     NE10_DECLARE_3(float32x4x2_t,q2_tw);
<a name="l00327"></a>00327     NE10_DECLARE_4(float32x4x2_t,q2_in);
<a name="l00328"></a>00328     NE10_DECLARE_4(float32x4x2_t,q2_out);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330     <span class="keywordflow">for</span> (m_count = loop_count; m_count &gt; 0; m_count -- )
<a name="l00331"></a>00331     {
<a name="l00332"></a>00332         <span class="comment">// load</span>
<a name="l00333"></a>00333         q2_in0.val[0] = vld1q_f32( (ne10_float32_t*) ( Fin_neon                      ) );
<a name="l00334"></a>00334         q2_in0.val[1] = vld1q_f32( (ne10_float32_t*) ( Fin_neon                   + 1) );
<a name="l00335"></a>00335 
<a name="l00336"></a>00336         q2_in1.val[0] = vld1q_f32( (ne10_float32_t*) ( Fin_neon + (out_step &lt;&lt; 1)    ) );
<a name="l00337"></a>00337         q2_in1.val[1] = vld1q_f32( (ne10_float32_t*) ( Fin_neon + (out_step &lt;&lt; 1) + 1) );
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         q2_in2.val[0] = vld1q_f32( (ne10_float32_t*) ( Fin_b                         ) );
<a name="l00340"></a>00340         q2_in2.val[1] = vld1q_f32( (ne10_float32_t*) ( Fin_b                      + 1) );
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         q2_in3.val[0] = vld1q_f32( (ne10_float32_t*) ( Fin_b    - (out_step &lt;&lt; 1)    ) );
<a name="l00343"></a>00343         q2_in3.val[1] = vld1q_f32( (ne10_float32_t*) ( Fin_b    - (out_step &lt;&lt; 1) + 1) );
<a name="l00344"></a>00344 
<a name="l00345"></a>00345         q2_tw0.val[0] = vdupq_n_f32(twiddles[0].r);
<a name="l00346"></a>00346         q2_tw0.val[1] = vdupq_n_f32(twiddles[0].i);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348         q2_tw1.val[0] = vdupq_n_f32(twiddles[out_step].r);
<a name="l00349"></a>00349         q2_tw1.val[1] = vdupq_n_f32(twiddles[out_step].i);
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         q2_tw2.val[0] = vdupq_n_f32(twiddles[out_step*2].r);
<a name="l00352"></a>00352         q2_tw2.val[1] = vdupq_n_f32(twiddles[out_step*2].i);
<a name="l00353"></a>00353 
<a name="l00354"></a>00354         <span class="comment">// NE10_PRINT_Q2x4_VECTOR(q2_in);</span>
<a name="l00355"></a>00355 
<a name="l00356"></a>00356         <span class="comment">// R2C TW KERNEL</span>
<a name="l00357"></a>00357         NE10_RADIX4x4_C2R_TW_NEON_KERNEL(q2_out,q2_in,q2_tw);
<a name="l00358"></a>00358 
<a name="l00359"></a>00359         <span class="comment">// NE10_PRINT_Q2x4_VECTOR(q2_out);</span>
<a name="l00360"></a>00360 
<a name="l00361"></a>00361         <span class="comment">// store</span>
<a name="l00362"></a>00362         vst1q_f32( (ne10_float32_t*) (Fout_neon + 0*in_step    ), q2_out0.val[0] );
<a name="l00363"></a>00363         vst1q_f32( (ne10_float32_t*) (Fout_neon + 0*in_step + 1), q2_out0.val[1] );
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         vst1q_f32( (ne10_float32_t*) (Fout_neon + 1*in_step    ), q2_out1.val[0] );
<a name="l00366"></a>00366         vst1q_f32( (ne10_float32_t*) (Fout_neon + 1*in_step + 1), q2_out1.val[1] );
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         vst1q_f32( (ne10_float32_t*) (Fout_neon + 2*in_step    ), q2_out2.val[0] );
<a name="l00369"></a>00369         vst1q_f32( (ne10_float32_t*) (Fout_neon + 2*in_step + 1), q2_out2.val[1] );
<a name="l00370"></a>00370 
<a name="l00371"></a>00371         vst1q_f32( (ne10_float32_t*) (Fout_neon + 3*in_step    ), q2_out3.val[0] );
<a name="l00372"></a>00372         vst1q_f32( (ne10_float32_t*) (Fout_neon + 3*in_step + 1), q2_out3.val[1] );
<a name="l00373"></a>00373 
<a name="l00374"></a>00374         <span class="comment">// update pointers</span>
<a name="l00375"></a>00375         Fin_neon  += 2;
<a name="l00376"></a>00376         Fout_neon += 2;
<a name="l00377"></a>00377         Fin_b    -= 2;
<a name="l00378"></a>00378         twiddles ++;
<a name="l00379"></a>00379     }
<a name="l00380"></a>00380 }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_r2c_with_twiddles_last_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00383"></a>00383                                                             <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00384"></a>00384                                                             <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00385"></a>00385                                                             <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00386"></a>00386                                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00387"></a>00387 {
<a name="l00388"></a>00388     NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00389"></a>00389     NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="comment">// load</span>
<a name="l00392"></a>00392     NE10_RADIX4x4_R2C_NEON_LOAD(Fin_neon,q_in,in_step);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     NE10_RADIX4x4_R2C_TW_NEON_KERNEL_LAST(q_out,q_in);
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="comment">// store</span>
<a name="l00397"></a>00397     vst1q_f32( (ne10_float32_t*) (Fout_neon    ), q_out0);
<a name="l00398"></a>00398     vst1q_f32( (ne10_float32_t*) (Fout_neon + 1), q_out1);
<a name="l00399"></a>00399     vst1q_f32( (ne10_float32_t*) (Fout_neon + (out_step &lt;&lt; 1)    ), q_out2);
<a name="l00400"></a>00400     vst1q_f32( (ne10_float32_t*) (Fout_neon + (out_step &lt;&lt; 1) + 1), q_out3);
<a name="l00401"></a>00401 }
<a name="l00402"></a>00402 
<a name="l00403"></a>00403 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_c2r_with_twiddles_last_butterfly_neon (float32x4_t *Fout_neon,
<a name="l00404"></a>00404                                                             <span class="keyword">const</span> float32x4_t *Fin_neon,
<a name="l00405"></a>00405                                                             <span class="keyword">const</span> ne10_int32_t out_step,
<a name="l00406"></a>00406                                                             <span class="keyword">const</span> ne10_int32_t in_step,
<a name="l00407"></a>00407                                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00408"></a>00408 {
<a name="l00409"></a>00409     NE10_DECLARE_4(float32x4_t,q_in);
<a name="l00410"></a>00410     NE10_DECLARE_4(float32x4_t,q_out);
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="comment">// load</span>
<a name="l00413"></a>00413     q_in0 = vld1q_f32( (ne10_float32_t*) (Fin_neon    ) );
<a name="l00414"></a>00414     q_in1 = vld1q_f32( (ne10_float32_t*) (Fin_neon + 1) );
<a name="l00415"></a>00415     q_in2 = vld1q_f32( (ne10_float32_t*) (Fin_neon + (out_step &lt;&lt; 1)    ) );
<a name="l00416"></a>00416     q_in3 = vld1q_f32( (ne10_float32_t*) (Fin_neon + (out_step &lt;&lt; 1) + 1) );
<a name="l00417"></a>00417 
<a name="l00418"></a>00418     <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_in);</span>
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     NE10_RADIX4x4_C2R_TW_NEON_KERNEL_LAST(q_out,q_in);
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     <span class="comment">// NE10_PRINT_Qx4_VECTOR(q_out);</span>
<a name="l00423"></a>00423 
<a name="l00424"></a>00424     <span class="comment">// store</span>
<a name="l00425"></a>00425     NE10_RADIX4x4_R2C_NEON_STORE(Fout_neon,q_out,in_step);
<a name="l00426"></a>00426 }
<a name="l00427"></a>00427 
<a name="l00428"></a>00428 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_r2c_with_twiddles_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00429"></a>00429                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00430"></a>00430                                                         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00431"></a>00431                                                         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00432"></a>00432                                                         <span class="keyword">const</span> ne10_int32_t nfft,
<a name="l00433"></a>00433                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00434"></a>00434 {
<a name="l00435"></a>00435     ne10_int32_t f_count;
<a name="l00436"></a>00436     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00437"></a>00437     <span class="keyword">const</span> ne10_int32_t out_step = mstride;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;
<a name="l00440"></a>00440           float32x4_t *Fout_neon = (float32x4_t*) Fout;
<a name="l00441"></a>00441     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l00442"></a>00442 
<a name="l00443"></a>00443     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00444"></a>00444     {
<a name="l00445"></a>00445         tw = twiddles;
<a name="l00446"></a>00446 
<a name="l00447"></a>00447         <span class="comment">// first butterfly</span>
<a name="l00448"></a>00448         ne10_radix4x4_r2c_with_twiddles_first_butterfly_neon ( Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00449"></a>00449 
<a name="l00450"></a>00450         tw ++;
<a name="l00451"></a>00451         Fin_neon ++;
<a name="l00452"></a>00452         Fout_neon ++;
<a name="l00453"></a>00453 
<a name="l00454"></a>00454         <span class="comment">// other butterfly</span>
<a name="l00455"></a>00455         ne10_radix4x4_r2c_with_twiddles_other_butterfly_neon ( Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00456"></a>00456 
<a name="l00457"></a>00457         <span class="comment">// update Fin_r, Fout_r, twiddles</span>
<a name="l00458"></a>00458         tw        +=     ( (out_step &gt;&gt; 1) - 1);
<a name="l00459"></a>00459         Fin_neon  += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00460"></a>00460         Fout_neon += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462         <span class="comment">// last butterfly</span>
<a name="l00463"></a>00463         ne10_radix4x4_r2c_with_twiddles_last_butterfly_neon (Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00464"></a>00464         Fin_neon ++;
<a name="l00465"></a>00465         tw++;
<a name="l00466"></a>00466         Fout_neon ++;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         Fout_neon = Fout_neon + 3 * out_step;
<a name="l00469"></a>00469     } <span class="comment">// f_count</span>
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a>00472 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4x4_c2r_with_twiddles_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fout,
<a name="l00473"></a>00473                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *Fin,
<a name="l00474"></a>00474                                                         <span class="keyword">const</span> ne10_int32_t fstride,
<a name="l00475"></a>00475                                                         <span class="keyword">const</span> ne10_int32_t mstride,
<a name="l00476"></a>00476                                                         <span class="keyword">const</span> ne10_int32_t nfft,
<a name="l00477"></a>00477                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles)
<a name="l00478"></a>00478 {
<a name="l00479"></a>00479     ne10_int32_t f_count;
<a name="l00480"></a>00480     <span class="keyword">const</span> ne10_int32_t in_step = nfft &gt;&gt; 2;
<a name="l00481"></a>00481     <span class="keyword">const</span> ne10_int32_t out_step = mstride;
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="keyword">const</span> float32x4_t *Fin_neon  = (float32x4_t*) Fin;
<a name="l00484"></a>00484           float32x4_t *Fout_neon = (float32x4_t*) Fout;
<a name="l00485"></a>00485     <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *tw;
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="keywordflow">for</span> (f_count = fstride; f_count; f_count --)
<a name="l00488"></a>00488     {
<a name="l00489"></a>00489         tw = twiddles;
<a name="l00490"></a>00490 
<a name="l00491"></a>00491         <span class="comment">// first butterfly</span>
<a name="l00492"></a>00492         ne10_radix4x4_c2r_with_twiddles_first_butterfly_neon ( Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00493"></a>00493 
<a name="l00494"></a>00494         tw ++;
<a name="l00495"></a>00495         Fin_neon ++;
<a name="l00496"></a>00496         Fout_neon ++;
<a name="l00497"></a>00497 
<a name="l00498"></a>00498         <span class="comment">// other butterfly</span>
<a name="l00499"></a>00499         ne10_radix4x4_c2r_with_twiddles_other_butterfly_neon ( Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         <span class="comment">// update Fin_r, Fout_r, twiddles</span>
<a name="l00502"></a>00502         tw        +=     ( (out_step &gt;&gt; 1) - 1);
<a name="l00503"></a>00503         Fin_neon  += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00504"></a>00504         Fout_neon += 2 * ( (out_step &gt;&gt; 1) - 1);
<a name="l00505"></a>00505 
<a name="l00506"></a>00506         <span class="comment">// last butterfly</span>
<a name="l00507"></a>00507         ne10_radix4x4_c2r_with_twiddles_last_butterfly_neon (Fout_neon, Fin_neon, out_step, in_step, tw);
<a name="l00508"></a>00508         Fin_neon ++;
<a name="l00509"></a>00509         tw++;
<a name="l00510"></a>00510         Fout_neon ++;
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         Fin_neon = Fin_neon + 3 * out_step;
<a name="l00513"></a>00513     } <span class="comment">// f_count</span>
<a name="l00514"></a>00514 }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516 NE10_INLINE <span class="keywordtype">void</span> ne10_mixed_radix_r2c_butterfly_float32_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00517"></a>00517                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00518"></a>00518                                                         <span class="keyword">const</span> ne10_int32_t * factors,
<a name="l00519"></a>00519                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00520"></a>00520                                                         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00521"></a>00521 {
<a name="l00522"></a>00522     ne10_int32_t fstride, mstride, nfft;
<a name="l00523"></a>00523     ne10_int32_t radix;
<a name="l00524"></a>00524     ne10_int32_t stage_count;
<a name="l00525"></a>00525 
<a name="l00526"></a>00526     <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00527"></a>00527 
<a name="l00528"></a>00528     <span class="comment">// init fstride, mstride, radix, nfft</span>
<a name="l00529"></a>00529     stage_count = factors[0];
<a name="l00530"></a>00530     fstride     = factors[1];
<a name="l00531"></a>00531     mstride     = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00532"></a>00532     radix       = factors[  stage_count &lt;&lt; 1 ];
<a name="l00533"></a>00533     nfft        = radix * fstride; <span class="comment">// not the real nfft</span>
<a name="l00534"></a>00534 
<a name="l00535"></a>00535     <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00536"></a>00536 
<a name="l00537"></a>00537     <span class="keywordflow">if</span> (radix == 2)
<a name="l00538"></a>00538     {
<a name="l00539"></a>00539         <span class="comment">// combine one radix-4 and one radix-2 into one radix-8</span>
<a name="l00540"></a>00540         mstride &lt;&lt;= 2;
<a name="l00541"></a>00541         fstride &gt;&gt;= 2;
<a name="l00542"></a>00542         twiddles += 6;
<a name="l00543"></a>00543         stage_count --;
<a name="l00544"></a>00544     }
<a name="l00545"></a>00545 
<a name="l00546"></a>00546     <span class="keywordflow">if</span> (stage_count % 2 == 1) <span class="comment">// since there is another stage outside</span>
<a name="l00547"></a>00547     {
<a name="l00548"></a>00548         ne10_swap_ptr (buffer, Fout);
<a name="l00549"></a>00549     }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551     <span class="comment">// the first stage</span>
<a name="l00552"></a>00552     <span class="keywordflow">if</span> (radix == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00553"></a>00553     {
<a name="l00554"></a>00554         ne10_radix8x4_r2c_neon (Fout, Fin, fstride, mstride, nfft);
<a name="l00555"></a>00555     }
<a name="l00556"></a>00556     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radix == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00557"></a>00557     {
<a name="l00558"></a>00558         ne10_radix4x4_r2c_neon (Fout, Fin, fstride, mstride, nfft);
<a name="l00559"></a>00559     }
<a name="l00560"></a>00560     <span class="comment">// end of first stage</span>
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="comment">// others</span>
<a name="l00563"></a>00563     <span class="keywordflow">for</span> (; fstride &gt; 1;)
<a name="l00564"></a>00564     {
<a name="l00565"></a>00565         fstride &gt;&gt;= 2;
<a name="l00566"></a>00566         ne10_swap_ptr (buffer, Fout);
<a name="l00567"></a>00567 
<a name="l00568"></a>00568         ne10_radix4x4_r2c_with_twiddles_neon (Fout, buffer, fstride, mstride, nfft, twiddles);
<a name="l00569"></a>00569         twiddles += 3 * mstride;
<a name="l00570"></a>00570         mstride &lt;&lt;= 2;
<a name="l00571"></a>00571     } <span class="comment">// other stage</span>
<a name="l00572"></a>00572 }
<a name="l00573"></a>00573 
<a name="l00574"></a>00574 NE10_INLINE <span class="keywordtype">void</span> ne10_mixed_radix_c2r_butterfly_float32_neon (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fout,
<a name="l00575"></a>00575                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * Fin,
<a name="l00576"></a>00576                                                         <span class="keyword">const</span> ne10_int32_t * factors,
<a name="l00577"></a>00577                                                         <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * twiddles,
<a name="l00578"></a>00578                                                         <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * buffer)
<a name="l00579"></a>00579 {
<a name="l00580"></a>00580     ne10_int32_t fstride, mstride, nfft;
<a name="l00581"></a>00581     ne10_int32_t radix;
<a name="l00582"></a>00582     ne10_int32_t stage_count;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00585"></a>00585 
<a name="l00586"></a>00586     <span class="comment">// init fstride, mstride, radix, nfft</span>
<a name="l00587"></a>00587     stage_count = factors[0];
<a name="l00588"></a>00588     fstride     = factors[1];
<a name="l00589"></a>00589 
<a name="l00590"></a>00590     mstride     = factors[ (stage_count &lt;&lt; 1) - 1 ];
<a name="l00591"></a>00591     radix       = factors[  stage_count &lt;&lt; 1 ];
<a name="l00592"></a>00592     nfft        = radix * fstride; <span class="comment">// not the real nfft</span>
<a name="l00593"></a>00593 
<a name="l00594"></a>00594     <span class="comment">// fstride, mstride for last last stage</span>
<a name="l00595"></a>00595     fstride = 1;
<a name="l00596"></a>00596     mstride = nfft &gt;&gt; 2;
<a name="l00597"></a>00597 
<a name="l00598"></a>00598     <span class="keywordflow">if</span> (radix == 2)
<a name="l00599"></a>00599     {
<a name="l00600"></a>00600         <span class="comment">// combine one radix-4 and one radix-2 into one radix-8</span>
<a name="l00601"></a>00601         stage_count --;
<a name="l00602"></a>00602     }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604     <span class="keywordflow">if</span> (stage_count % 2 == 0)
<a name="l00605"></a>00605     {
<a name="l00606"></a>00606         ne10_swap_ptr(Fout,buffer);
<a name="l00607"></a>00607     }
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     <span class="comment">// others but the first stage</span>
<a name="l00610"></a>00610     <span class="keywordflow">for</span> (; stage_count &gt; 1;)
<a name="l00611"></a>00611     {
<a name="l00612"></a>00612         twiddles -= 3 * mstride;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00615"></a>00615         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00616"></a>00616         ne10_radix4x4_c2r_with_twiddles_neon (Fout, buffer, fstride, mstride, nfft, twiddles);
<a name="l00617"></a>00617 
<a name="l00618"></a>00618         fstride &lt;&lt;= 2;
<a name="l00619"></a>00619         mstride &gt;&gt;= 2;
<a name="l00620"></a>00620         stage_count --;
<a name="l00621"></a>00621         ne10_swap_ptr (buffer, Fout);
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 
<a name="l00624"></a>00624     <span class="comment">// first stage -- inversed</span>
<a name="l00625"></a>00625     <span class="keywordflow">if</span> (radix == 2)   <span class="comment">// length of FFT is 2^n (n is odd)</span>
<a name="l00626"></a>00626     {
<a name="l00627"></a>00627         mstride &gt;&gt;= 1;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00630"></a>00630         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00631"></a>00631         ne10_radix8x4_c2r_neon (Fout, buffer, fstride, mstride, nfft);
<a name="l00632"></a>00632     }
<a name="l00633"></a>00633     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radix == 4)   <span class="comment">// length of FFT is 2^n (n is even)</span>
<a name="l00634"></a>00634     {
<a name="l00635"></a>00635         <span class="comment">// PRINT_STAGE_INFO;</span>
<a name="l00636"></a>00636         <span class="comment">// PRINT_POINTERS_INFO(Fin,Fout,buffer,twiddles);</span>
<a name="l00637"></a>00637         ne10_radix4x4_c2r_neon (Fout, buffer, fstride, mstride, nfft);
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639 }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_last_stage_first_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l00642"></a>00642                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l00643"></a>00643                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l00644"></a>00644                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00645"></a>00645 {
<a name="l00646"></a>00646     <span class="comment">// b0</span>
<a name="l00647"></a>00647     {
<a name="l00648"></a>00648         ne10_float32_t q_4r_out[4];
<a name="l00649"></a>00649         <span class="keyword">const</span> ne10_float32_t *p_src_r = (<span class="keyword">const</span> ne10_float32_t*) src;
<a name="l00650"></a>00650 
<a name="l00651"></a>00651         NE10_FFT_R2C_4R_RCR(q_4r_out,p_src_r);
<a name="l00652"></a>00652 
<a name="l00653"></a>00653         dst[0].r = q_4r_out[0];
<a name="l00654"></a>00654         dst[0].i = q_4r_out[3];
<a name="l00655"></a>00655         dst += (nfft&gt;&gt;2);
<a name="l00656"></a>00656         dst[0].r = q_4r_out[1];
<a name="l00657"></a>00657         dst[0].i = q_4r_out[2];
<a name="l00658"></a>00658         dst -= (nfft&gt;&gt;2);
<a name="l00659"></a>00659     }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661     <span class="comment">// b2</span>
<a name="l00662"></a>00662     {
<a name="l00663"></a>00663         <span class="keyword">const</span> ne10_float32_t *p_src_r = (<span class="keyword">const</span> ne10_float32_t*) (src);
<a name="l00664"></a>00664         p_src_r  += nfft;
<a name="l00665"></a>00665         p_src_r  -= 4;
<a name="l00666"></a>00666 
<a name="l00667"></a>00667         ne10_float32_t q_4r_out[4];
<a name="l00668"></a>00668 
<a name="l00669"></a>00669         NE10_FFT_R2C_4R_CC(q_4r_out,p_src_r);
<a name="l00670"></a>00670 
<a name="l00671"></a>00671         dst += (nfft&gt;&gt;3);
<a name="l00672"></a>00672         dst[0].r = q_4r_out[0];
<a name="l00673"></a>00673         dst[0].i = q_4r_out[1];
<a name="l00674"></a>00674         dst += (nfft&gt;&gt;2);
<a name="l00675"></a>00675         dst[0].r = q_4r_out[2];
<a name="l00676"></a>00676         dst[0].i = q_4r_out[3];
<a name="l00677"></a>00677         dst -= (nfft&gt;&gt;3);
<a name="l00678"></a>00678         dst -= (nfft&gt;&gt;2);
<a name="l00679"></a>00679     }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681     <span class="comment">// b1</span>
<a name="l00682"></a>00682     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> cc_out[4];
<a name="l00683"></a>00683     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> cc_in [4];
<a name="l00684"></a>00684     <span class="keyword">const</span> ne10_float32_t *p_src_r = (<span class="keyword">const</span> ne10_float32_t*) src;
<a name="l00685"></a>00685     p_src_r += 4;
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     cc_out[0].r = *(p_src_r ++);
<a name="l00688"></a>00688     cc_out[1].r = *(p_src_r ++);
<a name="l00689"></a>00689     cc_out[2].r = *(p_src_r ++);
<a name="l00690"></a>00690     cc_out[3].r = *(p_src_r ++);
<a name="l00691"></a>00691 
<a name="l00692"></a>00692     cc_out[0].i = *(p_src_r ++);
<a name="l00693"></a>00693     cc_out[1].i = *(p_src_r ++);
<a name="l00694"></a>00694     cc_out[2].i = *(p_src_r ++);
<a name="l00695"></a>00695     cc_out[3].i = *(p_src_r ++);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697     NE10_PRINT_Q2_VECTOR(cc_out);
<a name="l00698"></a>00698 
<a name="l00699"></a>00699     <span class="comment">// twiddles[0] = ( 1.0, 0.0);</span>
<a name="l00700"></a>00700     <span class="comment">// NE10_CPX_MUL_F32(cc_in[0],cc_out[0],twiddles[0]);</span>
<a name="l00701"></a>00701     cc_in[0] = cc_out[0];
<a name="l00702"></a>00702     twiddles ++;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704     NE10_CPX_MUL_F32(cc_in[1],cc_out[1],twiddles[0]);
<a name="l00705"></a>00705     twiddles ++;
<a name="l00706"></a>00706 
<a name="l00707"></a>00707     NE10_CPX_MUL_F32(cc_in[2],cc_out[2],twiddles[0]);
<a name="l00708"></a>00708     twiddles ++;
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     NE10_CPX_MUL_F32(cc_in[3],cc_out[3],twiddles[0]);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712     <span class="comment">// NE10_PRINT_Q2_VECTOR(cc_in);</span>
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     NE10_FFT_R2C_CC_CC(cc_out,cc_in);
<a name="l00715"></a>00715 
<a name="l00716"></a>00716     <span class="comment">// NE10_PRINT_Q2_VECTOR(cc_out);</span>
<a name="l00717"></a>00717 
<a name="l00718"></a>00718     dst[1] = cc_out[0];
<a name="l00719"></a>00719     dst += (nfft&gt;&gt;2);
<a name="l00720"></a>00720     dst[ 1] = cc_out[1];
<a name="l00721"></a>00721     dst[-1] = cc_out[3];
<a name="l00722"></a>00722     dst += (nfft&gt;&gt;2);
<a name="l00723"></a>00723     dst[-1] = cc_out[2];
<a name="l00724"></a>00724 }
<a name="l00725"></a>00725 
<a name="l00726"></a>00726 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_first_stage_first_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l00727"></a>00727                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l00728"></a>00728                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l00729"></a>00729                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00730"></a>00730 {
<a name="l00731"></a>00731     <span class="comment">// b0</span>
<a name="l00732"></a>00732     {
<a name="l00733"></a>00733         ne10_float32_t q_4r_in[4];
<a name="l00734"></a>00734         ne10_float32_t *p_dst_r = (ne10_float32_t*) dst;
<a name="l00735"></a>00735 
<a name="l00736"></a>00736         q_4r_in[0] = src[0].r;
<a name="l00737"></a>00737         q_4r_in[3] = src[0].i;
<a name="l00738"></a>00738         src += (nfft&gt;&gt;2);
<a name="l00739"></a>00739         q_4r_in[1] = src[0].r;
<a name="l00740"></a>00740         q_4r_in[2] = src[0].i;
<a name="l00741"></a>00741         src -= (nfft&gt;&gt;2);
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         NE10_FFT_C2R_RCR_4R(p_dst_r,q_4r_in);
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746     <span class="comment">// b2</span>
<a name="l00747"></a>00747     {
<a name="l00748"></a>00748         <span class="comment">// float32x4_t q_in;</span>
<a name="l00749"></a>00749         ne10_float32_t *p_dst_r = (ne10_float32_t*) (dst);
<a name="l00750"></a>00750         p_dst_r  += nfft;
<a name="l00751"></a>00751         p_dst_r  -= 4;
<a name="l00752"></a>00752 
<a name="l00753"></a>00753         ne10_float32_t q_4r_in[4];
<a name="l00754"></a>00754         src += (nfft&gt;&gt;3);
<a name="l00755"></a>00755         q_4r_in[0] = src[0].r;
<a name="l00756"></a>00756         q_4r_in[1] = src[0].i;
<a name="l00757"></a>00757         src += (nfft&gt;&gt;2);
<a name="l00758"></a>00758         q_4r_in[2] = src[0].r;
<a name="l00759"></a>00759         q_4r_in[3] = src[0].i;
<a name="l00760"></a>00760         src -= (nfft&gt;&gt;3);
<a name="l00761"></a>00761         src -= (nfft&gt;&gt;2);
<a name="l00762"></a>00762 
<a name="l00763"></a>00763         NE10_FFT_C2R_CC_4R(p_dst_r,q_4r_in);
<a name="l00764"></a>00764     }
<a name="l00765"></a>00765 
<a name="l00766"></a>00766     <span class="comment">// b1</span>
<a name="l00767"></a>00767     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> cc_out[4];
<a name="l00768"></a>00768     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> cc_in [4];
<a name="l00769"></a>00769     ne10_float32_t *p_dst_r = (ne10_float32_t*) dst;
<a name="l00770"></a>00770     p_dst_r += 4;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772     <span class="comment">// load</span>
<a name="l00773"></a>00773     cc_out[0] = src[1];
<a name="l00774"></a>00774     src += (nfft&gt;&gt;2);
<a name="l00775"></a>00775     cc_out[2] = src[ 1];
<a name="l00776"></a>00776     cc_out[3] = src[-1];
<a name="l00777"></a>00777     src += (nfft&gt;&gt;2);
<a name="l00778"></a>00778     cc_out[1] = src[-1];
<a name="l00779"></a>00779 
<a name="l00780"></a>00780     <span class="comment">// NE10_PRINT_Q2_VECTOR(cc_out);</span>
<a name="l00781"></a>00781 
<a name="l00782"></a>00782     NE10_FFT_C2R_CC_CC(cc_in,cc_out);
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     <span class="comment">// NE10_PRINT_Q2_VECTOR(cc_in);</span>
<a name="l00785"></a>00785 
<a name="l00786"></a>00786     <span class="comment">// twiddles[0] = ( 1.0, 0.0);</span>
<a name="l00787"></a>00787     <span class="comment">// NE10_CPX_MUL_F32(cc_in[0],cc_out[0],twiddles[0]);</span>
<a name="l00788"></a>00788     cc_out[0] = cc_in[0];
<a name="l00789"></a>00789     twiddles ++;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791     NE10_CPX_CONJ_MUL_F32(cc_out[1],cc_in[1],twiddles[0]);
<a name="l00792"></a>00792     twiddles ++;
<a name="l00793"></a>00793 
<a name="l00794"></a>00794     NE10_CPX_CONJ_MUL_F32(cc_out[2],cc_in[2],twiddles[0]);
<a name="l00795"></a>00795     twiddles ++;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797     NE10_CPX_CONJ_MUL_F32(cc_out[3],cc_in[3],twiddles[0]);
<a name="l00798"></a>00798 
<a name="l00799"></a>00799     <span class="comment">// NE10_PRINT_Q2_VECTOR(cc_out);</span>
<a name="l00800"></a>00800 
<a name="l00801"></a>00801     *(p_dst_r ++) = cc_out[0].r;
<a name="l00802"></a>00802     *(p_dst_r ++) = cc_out[1].r;
<a name="l00803"></a>00803     *(p_dst_r ++) = cc_out[2].r;
<a name="l00804"></a>00804     *(p_dst_r ++) = cc_out[3].r;
<a name="l00805"></a>00805 
<a name="l00806"></a>00806     *(p_dst_r ++) = cc_out[0].i;
<a name="l00807"></a>00807     *(p_dst_r ++) = cc_out[1].i;
<a name="l00808"></a>00808     *(p_dst_r ++) = cc_out[2].i;
<a name="l00809"></a>00809     *(p_dst_r ++) = cc_out[3].i;
<a name="l00810"></a>00810 }
<a name="l00811"></a>00811 
<a name="l00812"></a>00812 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_last_stage_second_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l00813"></a>00813                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l00814"></a>00814                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l00815"></a>00815                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l00816"></a>00816 {
<a name="l00817"></a>00817     <span class="comment">// assert ( nfft % 4 == 0 );</span>
<a name="l00818"></a>00818     <span class="keyword">const</span> ne10_float32_t *fin_r  = (<span class="keyword">const</span> ne10_float32_t*) src + 12;
<a name="l00819"></a>00819           ne10_float32_t *fout_r =       (ne10_float32_t*) dst;
<a name="l00820"></a>00820     <span class="keyword">const</span> ne10_float32_t *tw     = (<span class="keyword">const</span> ne10_float32_t*) twiddles + 8;
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     ne10_float32_t q_in0[4],    q_out0[4],
<a name="l00823"></a>00823                    q_in1[4],    q_out1[4],
<a name="l00824"></a>00824                    q_in2[4],    q_out2[4],
<a name="l00825"></a>00825                    q_in3[4],    q_out3[4];
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     ne10_float32_t q2_tw0[2][4],
<a name="l00828"></a>00828                    q2_tw1[2][4];
<a name="l00829"></a>00829 
<a name="l00830"></a>00830     <span class="comment">/*  INPUT &amp; OUTPUT</span>
<a name="l00831"></a>00831 <span class="comment">     *  0R  1R  2R  3R      Q0</span>
<a name="l00832"></a>00832 <span class="comment">     *  0I  1I  2I  3I      Q1</span>
<a name="l00833"></a>00833 <span class="comment">     *  4R  5R  6R  7R      Q2</span>
<a name="l00834"></a>00834 <span class="comment">     *  4I  5I  6I  7I      Q3</span>
<a name="l00835"></a>00835 <span class="comment">     */</span>
<a name="l00836"></a>00836 
<a name="l00837"></a>00837     q_in0[0] = *(fin_r++);
<a name="l00838"></a>00838     q_in0[1] = *(fin_r++);
<a name="l00839"></a>00839     q_in0[2] = *(fin_r++);
<a name="l00840"></a>00840     q_in0[3] = *(fin_r++);
<a name="l00841"></a>00841     q_in1[0] = *(fin_r++);
<a name="l00842"></a>00842     q_in1[1] = *(fin_r++);
<a name="l00843"></a>00843     q_in1[2] = *(fin_r++);
<a name="l00844"></a>00844     q_in1[3] = *(fin_r++);
<a name="l00845"></a>00845     q_in2[0] = *(fin_r++);
<a name="l00846"></a>00846     q_in2[1] = *(fin_r++);
<a name="l00847"></a>00847     q_in2[2] = *(fin_r++);
<a name="l00848"></a>00848     q_in2[3] = *(fin_r++);
<a name="l00849"></a>00849     q_in3[0] = *(fin_r++);
<a name="l00850"></a>00850     q_in3[1] = *(fin_r++);
<a name="l00851"></a>00851     q_in3[2] = *(fin_r++);
<a name="l00852"></a>00852     q_in3[3] = *(fin_r++);
<a name="l00853"></a>00853 
<a name="l00854"></a>00854     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in0);</span>
<a name="l00855"></a>00855     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in1);</span>
<a name="l00856"></a>00856     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in2);</span>
<a name="l00857"></a>00857     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in3);</span>
<a name="l00858"></a>00858 
<a name="l00859"></a>00859     q2_tw0[0][0] = tw[0];
<a name="l00860"></a>00860     q2_tw0[0][1] = tw[2];
<a name="l00861"></a>00861     q2_tw0[0][2] = tw[4];
<a name="l00862"></a>00862     q2_tw0[0][3] = tw[6];
<a name="l00863"></a>00863     q2_tw0[1][0] = tw[1];
<a name="l00864"></a>00864     q2_tw0[1][1] = tw[3];
<a name="l00865"></a>00865     q2_tw0[1][2] = tw[5];
<a name="l00866"></a>00866     q2_tw0[1][3] = tw[7];
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     q2_tw1[0][0] = tw[0+8];
<a name="l00869"></a>00869     q2_tw1[0][1] = tw[2+8];
<a name="l00870"></a>00870     q2_tw1[0][2] = tw[4+8];
<a name="l00871"></a>00871     q2_tw1[0][3] = tw[6+8];
<a name="l00872"></a>00872     q2_tw1[1][0] = tw[1+8];
<a name="l00873"></a>00873     q2_tw1[1][1] = tw[3+8];
<a name="l00874"></a>00874     q2_tw1[1][2] = tw[5+8];
<a name="l00875"></a>00875     q2_tw1[1][3] = tw[7+8];
<a name="l00876"></a>00876 
<a name="l00877"></a>00877     <span class="comment">// TW: in-&gt;out</span>
<a name="l00878"></a>00878     q_out0[0] = q_in0[0];
<a name="l00879"></a>00879     q_out1[0] = q_in1[0];
<a name="l00880"></a>00880     q_out2[0] = q_in2[0];
<a name="l00881"></a>00881     q_out3[0] = q_in3[0];
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="comment">//----------------------------------------------------------//</span>
<a name="l00884"></a>00884     <span class="comment">// first 2 lines</span>
<a name="l00885"></a>00885     <span class="comment">//   R          R             R           I             I</span>
<a name="l00886"></a>00886     q_out0[1] = q_in0[1] * q2_tw0[0][1] - q_in1[1] * q2_tw0[1][1];
<a name="l00887"></a>00887     <span class="comment">//   I          R             I           I             R</span>
<a name="l00888"></a>00888     q_out1[1] = q_in0[1] * q2_tw0[1][1] + q_in1[1] * q2_tw0[0][1];
<a name="l00889"></a>00889 
<a name="l00890"></a>00890     <span class="comment">//   R          R             R           I             I</span>
<a name="l00891"></a>00891     q_out0[2] = q_in0[2] * q2_tw0[0][2] - q_in1[2] * q2_tw0[1][2];
<a name="l00892"></a>00892     <span class="comment">//   I          R             I           I             R</span>
<a name="l00893"></a>00893     q_out1[2] = q_in0[2] * q2_tw0[1][2] + q_in1[2] * q2_tw0[0][2];
<a name="l00894"></a>00894 
<a name="l00895"></a>00895     <span class="comment">//   R          R             R           I             I</span>
<a name="l00896"></a>00896     q_out0[3] = q_in0[3] * q2_tw0[0][3] - q_in1[3] * q2_tw0[1][3];
<a name="l00897"></a>00897     <span class="comment">//   I          R             I           I             R</span>
<a name="l00898"></a>00898     q_out1[3] = q_in0[3] * q2_tw0[1][3] + q_in1[3] * q2_tw0[0][3];
<a name="l00899"></a>00899 
<a name="l00900"></a>00900     <span class="comment">//---------------------------------------------------------//</span>
<a name="l00901"></a>00901     <span class="comment">// second 2 lines</span>
<a name="l00902"></a>00902     <span class="comment">//   R          R             R           I             I</span>
<a name="l00903"></a>00903     q_out2[1] = q_in2[1] * q2_tw1[0][1] - q_in3[1] * q2_tw1[1][1];
<a name="l00904"></a>00904     <span class="comment">//   I          R             I           I             R</span>
<a name="l00905"></a>00905     q_out3[1] = q_in2[1] * q2_tw1[1][1] + q_in3[1] * q2_tw1[0][1];
<a name="l00906"></a>00906 
<a name="l00907"></a>00907     <span class="comment">//   R          R             R           I             I</span>
<a name="l00908"></a>00908     q_out2[2] = q_in2[2] * q2_tw1[0][2] - q_in3[2] * q2_tw1[1][2];
<a name="l00909"></a>00909     <span class="comment">//   I          R             I           I             R</span>
<a name="l00910"></a>00910     q_out3[2] = q_in2[2] * q2_tw1[1][2] + q_in3[2] * q2_tw1[0][2];
<a name="l00911"></a>00911 
<a name="l00912"></a>00912     <span class="comment">//   R          R             R           I             I</span>
<a name="l00913"></a>00913     q_out2[3] = q_in2[3] * q2_tw1[0][3] - q_in3[3] * q2_tw1[1][3];
<a name="l00914"></a>00914     <span class="comment">//   I          R             I           I             R</span>
<a name="l00915"></a>00915     q_out3[3] = q_in2[3] * q2_tw1[1][3] + q_in3[3] * q2_tw1[0][3];
<a name="l00916"></a>00916 
<a name="l00917"></a>00917     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out0);</span>
<a name="l00918"></a>00918     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out1);</span>
<a name="l00919"></a>00919     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out2);</span>
<a name="l00920"></a>00920     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out3);</span>
<a name="l00921"></a>00921 
<a name="l00922"></a>00922     <span class="comment">// BUTTERFLY - radix 4x2</span>
<a name="l00923"></a>00923     <span class="comment">// STAGE</span>
<a name="l00924"></a>00924     <span class="comment">// q_out -&gt; q_in</span>
<a name="l00925"></a>00925     <span class="comment">//  R i         R j         R k</span>
<a name="l00926"></a>00926     q_in0[0] = q_out0[0] + q_out0[2];
<a name="l00927"></a>00927     q_in1[0] = q_out1[0] + q_out1[2];
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     q_in0[1] = q_out0[0] - q_out0[2];
<a name="l00930"></a>00930     q_in1[1] = q_out1[0] - q_out1[2];
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     <span class="comment">//  R i         R j         R k</span>
<a name="l00933"></a>00933     q_in0[2] = q_out0[1] + q_out0[3];
<a name="l00934"></a>00934     q_in1[2] = q_out1[1] + q_out1[3];
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     q_in0[3] = q_out0[1] - q_out0[3];
<a name="l00937"></a>00937     q_in1[3] = q_out1[1] - q_out1[3];
<a name="l00938"></a>00938 
<a name="l00939"></a>00939     <span class="comment">//  R i         R j         R k</span>
<a name="l00940"></a>00940     q_in2[0] = q_out2[0] + q_out2[2];
<a name="l00941"></a>00941     q_in3[0] = q_out3[0] + q_out3[2];
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     q_in2[1] = q_out2[0] - q_out2[2];
<a name="l00944"></a>00944     q_in3[1] = q_out3[0] - q_out3[2];
<a name="l00945"></a>00945 
<a name="l00946"></a>00946     <span class="comment">//  R i         R j         R k</span>
<a name="l00947"></a>00947     q_in2[2] = q_out2[1] + q_out2[3];
<a name="l00948"></a>00948     q_in3[2] = q_out3[1] + q_out3[3];
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     q_in2[3] = q_out2[1] - q_out2[3];
<a name="l00951"></a>00951     q_in3[3] = q_out3[1] - q_out3[3];
<a name="l00952"></a>00952 
<a name="l00953"></a>00953     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in0);</span>
<a name="l00954"></a>00954     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in1);</span>
<a name="l00955"></a>00955     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in2);</span>
<a name="l00956"></a>00956     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in3);</span>
<a name="l00957"></a>00957 
<a name="l00958"></a>00958     <span class="comment">// STAGE</span>
<a name="l00959"></a>00959     <span class="comment">// q_in -&gt; q_out</span>
<a name="l00960"></a>00960     <span class="comment">// and transpose</span>
<a name="l00961"></a>00961     <span class="comment">//   R i          R j        R k</span>
<a name="l00962"></a>00962     q_out0[0] =   q_in0[0] + q_in0[2];
<a name="l00963"></a>00963     q_out0[1] =   q_in1[0] + q_in1[2];
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     q_out2[2] =   q_in0[0] - q_in0[2];
<a name="l00966"></a>00966     q_out2[3] = - q_in1[0] + q_in1[2];<span class="comment">// CONJ</span>
<a name="l00967"></a>00967 
<a name="l00968"></a>00968     <span class="comment">//   R i          R j        R k</span>
<a name="l00969"></a>00969     q_out3[2] =   q_in0[1] - q_in1[3];
<a name="l00970"></a>00970     q_out3[3] = - q_in1[1] - q_in0[3];<span class="comment">// CONJ</span>
<a name="l00971"></a>00971 
<a name="l00972"></a>00972     q_out1[0] =   q_in0[1] + q_in1[3];
<a name="l00973"></a>00973     q_out1[1] =   q_in1[1] - q_in0[3];
<a name="l00974"></a>00974 
<a name="l00975"></a>00975     <span class="comment">//   R i          R j        R k</span>
<a name="l00976"></a>00976     q_out0[2] =   q_in2[0] + q_in2[2];
<a name="l00977"></a>00977     q_out0[3] =   q_in3[0] + q_in3[2];
<a name="l00978"></a>00978 
<a name="l00979"></a>00979     q_out2[0] =   q_in2[0] - q_in2[2];
<a name="l00980"></a>00980     q_out2[1] = - q_in3[0] + q_in3[2];<span class="comment">// CONJ</span>
<a name="l00981"></a>00981 
<a name="l00982"></a>00982     <span class="comment">//   R i          R j        R k</span>
<a name="l00983"></a>00983     q_out3[0] =   q_in2[1] - q_in3[3];
<a name="l00984"></a>00984     q_out3[1] = - q_in3[1] - q_in2[3]; <span class="comment">// CONJ</span>
<a name="l00985"></a>00985 
<a name="l00986"></a>00986     q_out1[2] =   q_in2[1] + q_in3[3];
<a name="l00987"></a>00987     q_out1[3] =   q_in3[1] - q_in2[3];
<a name="l00988"></a>00988 
<a name="l00989"></a>00989     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out0);</span>
<a name="l00990"></a>00990     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out1);</span>
<a name="l00991"></a>00991     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out2);</span>
<a name="l00992"></a>00992     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out3);</span>
<a name="l00993"></a>00993 
<a name="l00994"></a>00994     <span class="comment">// STORE</span>
<a name="l00995"></a>00995     fout_r += 4;
<a name="l00996"></a>00996     fout_r[0] = q_out0[0];
<a name="l00997"></a>00997     fout_r[1] = q_out0[1];
<a name="l00998"></a>00998     fout_r[2] = q_out0[2];
<a name="l00999"></a>00999     fout_r[3] = q_out0[3];
<a name="l01000"></a>01000 
<a name="l01001"></a>01001     fout_r += (nfft&gt;&gt;1);
<a name="l01002"></a>01002     fout_r[0] = q_out1[0];
<a name="l01003"></a>01003     fout_r[1] = q_out1[1];
<a name="l01004"></a>01004     fout_r[2] = q_out1[2];
<a name="l01005"></a>01005     fout_r[3] = q_out1[3];
<a name="l01006"></a>01006 
<a name="l01007"></a>01007     fout_r -= 10;
<a name="l01008"></a>01008     fout_r[0] = q_out3[0];
<a name="l01009"></a>01009     fout_r[1] = q_out3[1];
<a name="l01010"></a>01010     fout_r[2] = q_out3[2];
<a name="l01011"></a>01011     fout_r[3] = q_out3[3];
<a name="l01012"></a>01012 
<a name="l01013"></a>01013     fout_r += (nfft&gt;&gt;1);
<a name="l01014"></a>01014     fout_r[0] = q_out2[0];
<a name="l01015"></a>01015     fout_r[1] = q_out2[1];
<a name="l01016"></a>01016     fout_r[2] = q_out2[2];
<a name="l01017"></a>01017     fout_r[3] = q_out2[3];
<a name="l01018"></a>01018 }
<a name="l01019"></a>01019 
<a name="l01020"></a>01020 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_first_stage_second_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l01021"></a>01021                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l01022"></a>01022                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l01023"></a>01023                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l01024"></a>01024 {
<a name="l01025"></a>01025     <span class="keyword">const</span> ne10_float32_t *fin_r  = (<span class="keyword">const</span> ne10_float32_t*) src;
<a name="l01026"></a>01026           ne10_float32_t *fout_r =       (ne10_float32_t*) dst + 12;
<a name="l01027"></a>01027     <span class="keyword">const</span> ne10_float32_t *tw     = (<span class="keyword">const</span> ne10_float32_t*) twiddles + 8;
<a name="l01028"></a>01028 
<a name="l01029"></a>01029     ne10_float32_t q_in0[4],    q_out0[4],
<a name="l01030"></a>01030                    q_in1[4],    q_out1[4],
<a name="l01031"></a>01031                    q_in2[4],    q_out2[4],
<a name="l01032"></a>01032                    q_in3[4],    q_out3[4];
<a name="l01033"></a>01033 
<a name="l01034"></a>01034     ne10_float32_t q2_tw0[2][4],
<a name="l01035"></a>01035                    q2_tw1[2][4];
<a name="l01036"></a>01036 
<a name="l01037"></a>01037     <span class="comment">/*  INPUT &amp; OUTPUT</span>
<a name="l01038"></a>01038 <span class="comment">     *  0R  1R  2R  3R      Q0</span>
<a name="l01039"></a>01039 <span class="comment">     *  0I  1I  2I  3I      Q1</span>
<a name="l01040"></a>01040 <span class="comment">     *  4R  5R  6R  7R      Q2</span>
<a name="l01041"></a>01041 <span class="comment">     *  4I  5I  6I  7I      Q3</span>
<a name="l01042"></a>01042 <span class="comment">     */</span>
<a name="l01043"></a>01043 
<a name="l01044"></a>01044     <span class="comment">// load</span>
<a name="l01045"></a>01045     fin_r += 4;
<a name="l01046"></a>01046     q_in0[0] = fin_r[0];
<a name="l01047"></a>01047     q_in0[1] = fin_r[1];
<a name="l01048"></a>01048     q_in0[2] = fin_r[2];
<a name="l01049"></a>01049     q_in0[3] = fin_r[3];
<a name="l01050"></a>01050 
<a name="l01051"></a>01051     fin_r += (nfft&gt;&gt;1);
<a name="l01052"></a>01052     q_in1[0] = fin_r[0];
<a name="l01053"></a>01053     q_in1[1] = fin_r[1];
<a name="l01054"></a>01054     q_in1[2] = fin_r[2];
<a name="l01055"></a>01055     q_in1[3] = fin_r[3];
<a name="l01056"></a>01056 
<a name="l01057"></a>01057     fin_r -= 10;
<a name="l01058"></a>01058     q_in3[0] = fin_r[0];
<a name="l01059"></a>01059     q_in3[1] = fin_r[1];
<a name="l01060"></a>01060     q_in3[2] = fin_r[2];
<a name="l01061"></a>01061     q_in3[3] = fin_r[3];
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     fin_r += (nfft&gt;&gt;1);
<a name="l01064"></a>01064     q_in2[0] = fin_r[0];
<a name="l01065"></a>01065     q_in2[1] = fin_r[1];
<a name="l01066"></a>01066     q_in2[2] = fin_r[2];
<a name="l01067"></a>01067     q_in2[3] = fin_r[3];
<a name="l01068"></a>01068 
<a name="l01069"></a>01069     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in0);</span>
<a name="l01070"></a>01070     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in1);</span>
<a name="l01071"></a>01071     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in2);</span>
<a name="l01072"></a>01072     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in3);</span>
<a name="l01073"></a>01073 
<a name="l01074"></a>01074     <span class="comment">// OUTPUT</span>
<a name="l01075"></a>01075     <span class="comment">// INPUT</span>
<a name="l01076"></a>01076 <span class="preprocessor">#define NE10_INV_BUTTERFLY_TMP(I1,I2,J1,J2,K1,K2,S1,S2) do {    \</span>
<a name="l01077"></a>01077 <span class="preprocessor">    q_out ## I1 [I2] = ( q_in ## K1 [K2] + q_in ## S1 [S2] ); \</span>
<a name="l01078"></a>01078 <span class="preprocessor">    q_out ## J1 [J2] = ( q_in ## K1 [K2] - q_in ## S1 [S2] ); \</span>
<a name="l01079"></a>01079 <span class="preprocessor">} while(0);</span>
<a name="l01080"></a>01080 <span class="preprocessor"></span>
<a name="l01081"></a>01081     <span class="comment">// STAGE</span>
<a name="l01082"></a>01082     <span class="comment">// q_in -&gt; q_out</span>
<a name="l01083"></a>01083     <span class="comment">// and transpose</span>
<a name="l01084"></a>01084     NE10_INV_BUTTERFLY_TMP( 0,0, 0,2,
<a name="l01085"></a>01085                             0,0, 2,2);
<a name="l01086"></a>01086 
<a name="l01087"></a>01087     NE10_INV_BUTTERFLY_TMP( 1,2, 1,0,
<a name="l01088"></a>01088                             0,1, 2,3);
<a name="l01089"></a>01089 
<a name="l01090"></a>01090     NE10_INV_BUTTERFLY_TMP( 0,1, 1,3,
<a name="l01091"></a>01091                             1,0, 3,2);
<a name="l01092"></a>01092 
<a name="l01093"></a>01093     q_in3[3] *= - 1.0f;
<a name="l01094"></a>01094     NE10_INV_BUTTERFLY_TMP( 1,1, 0,3,
<a name="l01095"></a>01095                             3,3, 1,1);
<a name="l01096"></a>01096 
<a name="l01097"></a>01097     NE10_INV_BUTTERFLY_TMP( 2,0, 2,2,
<a name="l01098"></a>01098                             0,2, 2,0);
<a name="l01099"></a>01099 
<a name="l01100"></a>01100     NE10_INV_BUTTERFLY_TMP( 3,2, 3,0,
<a name="l01101"></a>01101                             0,3, 2,1);
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     NE10_INV_BUTTERFLY_TMP( 2,1, 3,3,
<a name="l01104"></a>01104                             1,2, 3,0);
<a name="l01105"></a>01105 
<a name="l01106"></a>01106     q_in3[1] *= - 1.0f;
<a name="l01107"></a>01107     NE10_INV_BUTTERFLY_TMP( 3,1, 2,3,
<a name="l01108"></a>01108                             3,1, 1,3);
<a name="l01109"></a>01109 <span class="preprocessor">#undef NE10_INV_BUTTERFLY_TMP</span>
<a name="l01110"></a>01110 <span class="preprocessor"></span>
<a name="l01111"></a>01111     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out0);</span>
<a name="l01112"></a>01112     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out1);</span>
<a name="l01113"></a>01113     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out2);</span>
<a name="l01114"></a>01114     <span class="comment">// NE10_PRINT_Q_VECTOR(q_out3);</span>
<a name="l01115"></a>01115 
<a name="l01116"></a>01116     <span class="comment">// BUTTERFLY - radix 4x2</span>
<a name="l01117"></a>01117     <span class="comment">// STAGE</span>
<a name="l01118"></a>01118     <span class="comment">// q_out -&gt; q_in</span>
<a name="l01119"></a>01119 
<a name="l01120"></a>01120     <span class="comment">// OUTPUT</span>
<a name="l01121"></a>01121     <span class="comment">// INPUT</span>
<a name="l01122"></a>01122 <span class="preprocessor">#define NE10_INV_BUTTERFLY_TMP(I1,I2,J1,J2,K1,K2,S1,S2) do {    \</span>
<a name="l01123"></a>01123 <span class="preprocessor">    q_in ## I1 [I2] = ( q_out ## K1 [K2] + q_out ## S1 [S2] ); \</span>
<a name="l01124"></a>01124 <span class="preprocessor">    q_in ## J1 [J2] = ( q_out ## K1 [K2] - q_out ## S1 [S2] ); \</span>
<a name="l01125"></a>01125 <span class="preprocessor">} while(0);</span>
<a name="l01126"></a>01126 <span class="preprocessor"></span>
<a name="l01127"></a>01127     NE10_INV_BUTTERFLY_TMP(0,0, 0,2,
<a name="l01128"></a>01128                            0,0, 0,1);
<a name="l01129"></a>01129 
<a name="l01130"></a>01130     NE10_INV_BUTTERFLY_TMP(1,0, 1,2,
<a name="l01131"></a>01131                            1,0, 1,1);
<a name="l01132"></a>01132 
<a name="l01133"></a>01133     NE10_INV_BUTTERFLY_TMP(0,1, 0,3,
<a name="l01134"></a>01134                            0,2, 0,3);
<a name="l01135"></a>01135 
<a name="l01136"></a>01136     NE10_INV_BUTTERFLY_TMP(1,1, 1,3,
<a name="l01137"></a>01137                            1,2, 1,3);
<a name="l01138"></a>01138 
<a name="l01139"></a>01139     NE10_INV_BUTTERFLY_TMP(2,0, 2,2,
<a name="l01140"></a>01140                            2,0, 2,1);
<a name="l01141"></a>01141 
<a name="l01142"></a>01142     NE10_INV_BUTTERFLY_TMP(3,0, 3,2,
<a name="l01143"></a>01143                            3,0, 3,1);
<a name="l01144"></a>01144 
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     NE10_INV_BUTTERFLY_TMP(2,1, 2,3,
<a name="l01147"></a>01147                            2,2, 2,3);
<a name="l01148"></a>01148 
<a name="l01149"></a>01149     NE10_INV_BUTTERFLY_TMP(3,1, 3,3,
<a name="l01150"></a>01150                            3,2, 3,3);
<a name="l01151"></a>01151 
<a name="l01152"></a>01152     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in0);</span>
<a name="l01153"></a>01153     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in1);</span>
<a name="l01154"></a>01154     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in2);</span>
<a name="l01155"></a>01155     <span class="comment">// NE10_PRINT_Q_VECTOR(q_in3);</span>
<a name="l01156"></a>01156 <span class="preprocessor">#undef NE10_INV_BUTTERFLY_TMP</span>
<a name="l01157"></a>01157 <span class="preprocessor"></span>
<a name="l01158"></a>01158     <span class="comment">// load tw</span>
<a name="l01159"></a>01159     q2_tw0[0][0] = tw[0];
<a name="l01160"></a>01160     q2_tw0[0][1] = tw[2];
<a name="l01161"></a>01161     q2_tw0[0][2] = tw[4];
<a name="l01162"></a>01162     q2_tw0[0][3] = tw[6];
<a name="l01163"></a>01163     q2_tw0[1][0] = tw[1];
<a name="l01164"></a>01164     q2_tw0[1][1] = tw[3];
<a name="l01165"></a>01165     q2_tw0[1][2] = tw[5];
<a name="l01166"></a>01166     q2_tw0[1][3] = tw[7];
<a name="l01167"></a>01167 
<a name="l01168"></a>01168     q2_tw1[0][0] = tw[0+8];
<a name="l01169"></a>01169     q2_tw1[0][1] = tw[2+8];
<a name="l01170"></a>01170     q2_tw1[0][2] = tw[4+8];
<a name="l01171"></a>01171     q2_tw1[0][3] = tw[6+8];
<a name="l01172"></a>01172     q2_tw1[1][0] = tw[1+8];
<a name="l01173"></a>01173     q2_tw1[1][1] = tw[3+8];
<a name="l01174"></a>01174     q2_tw1[1][2] = tw[5+8];
<a name="l01175"></a>01175     q2_tw1[1][3] = tw[7+8];
<a name="l01176"></a>01176 
<a name="l01177"></a>01177     <span class="comment">// TW: in-&gt;out</span>
<a name="l01178"></a>01178     q_out0[0] = q_in0[0];
<a name="l01179"></a>01179     q_out1[0] = q_in1[0];
<a name="l01180"></a>01180     q_out2[0] = q_in2[0];
<a name="l01181"></a>01181     q_out3[0] = q_in3[0];
<a name="l01182"></a>01182 
<a name="l01183"></a>01183     <span class="comment">//----------------------------------------------------------//</span>
<a name="l01184"></a>01184     <span class="comment">// first 2 lines</span>
<a name="l01185"></a>01185     <span class="comment">//   R          R             R           I             I</span>
<a name="l01186"></a>01186     q_out0[1] = q_in0[1] * q2_tw0[0][1] + q_in1[1] * q2_tw0[1][1];
<a name="l01187"></a>01187     <span class="comment">//   I          R             I           I             R</span>
<a name="l01188"></a>01188     q_out1[1] = q_in0[1] * q2_tw0[1][1] - q_in1[1] * q2_tw0[0][1];
<a name="l01189"></a>01189 
<a name="l01190"></a>01190     <span class="comment">//   R          R             R           I             I</span>
<a name="l01191"></a>01191     q_out0[2] = q_in0[2] * q2_tw0[0][2] + q_in1[2] * q2_tw0[1][2];
<a name="l01192"></a>01192     <span class="comment">//   I          R             I           I             R</span>
<a name="l01193"></a>01193     q_out1[2] = q_in0[2] * q2_tw0[1][2] - q_in1[2] * q2_tw0[0][2];
<a name="l01194"></a>01194 
<a name="l01195"></a>01195     <span class="comment">//   R          R             R           I             I</span>
<a name="l01196"></a>01196     q_out0[3] = q_in0[3] * q2_tw0[0][3] + q_in1[3] * q2_tw0[1][3];
<a name="l01197"></a>01197     <span class="comment">//   I          R             I           I             R</span>
<a name="l01198"></a>01198     q_out1[3] = q_in0[3] * q2_tw0[1][3] - q_in1[3] * q2_tw0[0][3];
<a name="l01199"></a>01199 
<a name="l01200"></a>01200     <span class="comment">//----------------------------------------------------------//</span>
<a name="l01201"></a>01201     <span class="comment">// second 2 lines</span>
<a name="l01202"></a>01202     <span class="comment">//   R          R             R           I             I</span>
<a name="l01203"></a>01203     q_out2[1] = q_in2[1] * q2_tw1[0][1] + q_in3[1] * q2_tw1[1][1];
<a name="l01204"></a>01204     <span class="comment">//   I          R             I           I             R</span>
<a name="l01205"></a>01205     q_out3[1] = q_in2[1] * q2_tw1[1][1] - q_in3[1] * q2_tw1[0][1];
<a name="l01206"></a>01206 
<a name="l01207"></a>01207     <span class="comment">//   R          R             R           I             I</span>
<a name="l01208"></a>01208     q_out2[2] = q_in2[2] * q2_tw1[0][2] + q_in3[2] * q2_tw1[1][2];
<a name="l01209"></a>01209     <span class="comment">//   I          R             I           I             R</span>
<a name="l01210"></a>01210     q_out3[2] = q_in2[2] * q2_tw1[1][2] - q_in3[2] * q2_tw1[0][2];
<a name="l01211"></a>01211 
<a name="l01212"></a>01212     <span class="comment">//   R          R             R           I             I</span>
<a name="l01213"></a>01213     q_out2[3] = q_in2[3] * q2_tw1[0][3] + q_in3[3] * q2_tw1[1][3];
<a name="l01214"></a>01214     <span class="comment">//   I          R             I           I             R</span>
<a name="l01215"></a>01215     q_out3[3] = q_in2[3] * q2_tw1[1][3] - q_in3[3] * q2_tw1[0][3];
<a name="l01216"></a>01216 
<a name="l01217"></a>01217     <span class="comment">// STORE</span>
<a name="l01218"></a>01218     *(fout_r++) =   q_out0[0];
<a name="l01219"></a>01219     *(fout_r++) =   q_out0[1];
<a name="l01220"></a>01220     *(fout_r++) =   q_out0[2];
<a name="l01221"></a>01221     *(fout_r++) =   q_out0[3];
<a name="l01222"></a>01222     *(fout_r++) =   q_out1[0];
<a name="l01223"></a>01223     *(fout_r++) = - q_out1[1];
<a name="l01224"></a>01224     *(fout_r++) = - q_out1[2];
<a name="l01225"></a>01225     *(fout_r++) = - q_out1[3];
<a name="l01226"></a>01226     *(fout_r++) =   q_out2[0];
<a name="l01227"></a>01227     *(fout_r++) =   q_out2[1];
<a name="l01228"></a>01228     *(fout_r++) =   q_out2[2];
<a name="l01229"></a>01229     *(fout_r++) =   q_out2[3];
<a name="l01230"></a>01230     *(fout_r++) =   q_out3[0];
<a name="l01231"></a>01231     *(fout_r++) = - q_out3[1];
<a name="l01232"></a>01232     *(fout_r++) = - q_out3[2];
<a name="l01233"></a>01233     *(fout_r++) = - q_out3[3];
<a name="l01234"></a>01234 }
<a name="l01235"></a>01235 
<a name="l01236"></a>01236 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_last_stage_other_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l01237"></a>01237                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l01238"></a>01238                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l01239"></a>01239                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l01240"></a>01240 {
<a name="l01241"></a>01241     <span class="keyword">const</span> ne10_float32_t *fin_r  = ((<span class="keyword">const</span> ne10_float32_t*) src ) + 12 + 16 ;
<a name="l01242"></a>01242           ne10_float32_t *fout_r =        (ne10_float32_t*) dst + 8;
<a name="l01243"></a>01243           ne10_float32_t *fout_b =        (ne10_float32_t*) dst - 14;
<a name="l01244"></a>01244     <span class="keyword">const</span> ne10_float32_t *tw     = ((<span class="keyword">const</span> ne10_float32_t*) twiddles) + 8  + 16;
<a name="l01245"></a>01245     ne10_int32_t loop_count = ((nfft&gt;&gt;2)-8)&gt;&gt;3;
<a name="l01246"></a>01246 
<a name="l01247"></a>01247     <span class="keywordflow">for</span> ( ; loop_count&gt;0; loop_count -- )
<a name="l01248"></a>01248     {
<a name="l01249"></a>01249         NE10_DECLARE_4(float32x4x2_t,q2_in);    <span class="comment">// 8Q</span>
<a name="l01250"></a>01250         NE10_DECLARE_3(float32x4x2_t,q2_tw);    <span class="comment">// 6Q</span>
<a name="l01251"></a>01251         NE10_DECLARE_4(float32x4x2_t,q2_out);   <span class="comment">// 8Q</span>
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         <span class="comment">/*  INPUT</span>
<a name="l01254"></a>01254 <span class="comment">         *  0R  1R  2R  3R      Q0</span>
<a name="l01255"></a>01255 <span class="comment">         *  0I  1I  2I  3I      Q1</span>
<a name="l01256"></a>01256 <span class="comment">         *  4R  5R  6R  7R      Q2</span>
<a name="l01257"></a>01257 <span class="comment">         *  4I  5I  6I  7I      Q3</span>
<a name="l01258"></a>01258 <span class="comment">         *  8R  9R  aR  bR      Q4</span>
<a name="l01259"></a>01259 <span class="comment">         *  8I  9I  aI  bI      Q5</span>
<a name="l01260"></a>01260 <span class="comment">         *  cR  dR  eR  fR      Q6</span>
<a name="l01261"></a>01261 <span class="comment">         *  cI  dI  eI  fI      Q7</span>
<a name="l01262"></a>01262 <span class="comment">         */</span>
<a name="l01263"></a>01263 
<a name="l01264"></a>01264         q2_out0.val[0] = vld1q_f32(fin_r);
<a name="l01265"></a>01265         fin_r += 4;
<a name="l01266"></a>01266         q2_out0.val[1] = vld1q_f32(fin_r);
<a name="l01267"></a>01267         fin_r += 4;
<a name="l01268"></a>01268         q2_out1.val[0] = vld1q_f32(fin_r);
<a name="l01269"></a>01269         fin_r += 4;
<a name="l01270"></a>01270         q2_out1.val[1] = vld1q_f32(fin_r);
<a name="l01271"></a>01271         fin_r += 4;
<a name="l01272"></a>01272         q2_out2.val[0] = vld1q_f32(fin_r);
<a name="l01273"></a>01273         fin_r += 4;
<a name="l01274"></a>01274         q2_out2.val[1] = vld1q_f32(fin_r);
<a name="l01275"></a>01275         fin_r += 4;
<a name="l01276"></a>01276         q2_out3.val[0] = vld1q_f32(fin_r);
<a name="l01277"></a>01277         fin_r += 4;
<a name="l01278"></a>01278         q2_out3.val[1] = vld1q_f32(fin_r);
<a name="l01279"></a>01279         fin_r += 4;
<a name="l01280"></a>01280 
<a name="l01281"></a>01281         q2_tw0 = vld2q_f32(tw);
<a name="l01282"></a>01282         tw += 8;
<a name="l01283"></a>01283         q2_tw1 = vld2q_f32(tw);
<a name="l01284"></a>01284         tw += 8;
<a name="l01285"></a>01285         q2_tw2 = vld2q_f32(tw);
<a name="l01286"></a>01286         tw += 8;
<a name="l01287"></a>01287 
<a name="l01288"></a>01288         <span class="comment">// transpose</span>
<a name="l01289"></a>01289         <span class="comment">// q2_out -&gt; q2_in</span>
<a name="l01290"></a>01290         <span class="comment">/*</span>
<a name="l01291"></a>01291 <span class="comment">         *      val[0]</span>
<a name="l01292"></a>01292 <span class="comment">         *  0R  4R  8R  cR      Q0</span>
<a name="l01293"></a>01293 <span class="comment">         *  1R  5R  9R  dR      Q2</span>
<a name="l01294"></a>01294 <span class="comment">         *  2R  6R  aR  eR      Q4</span>
<a name="l01295"></a>01295 <span class="comment">         *  3R  7R  bR  fR      Q6</span>
<a name="l01296"></a>01296 <span class="comment">         *</span>
<a name="l01297"></a>01297 <span class="comment">         *      val[1]</span>
<a name="l01298"></a>01298 <span class="comment">         *  0I  4I  8I  cI      Q1</span>
<a name="l01299"></a>01299 <span class="comment">         *  1I  5I  9I  dI      Q3</span>
<a name="l01300"></a>01300 <span class="comment">         *  2I  6I  aI  eI      Q5</span>
<a name="l01301"></a>01301 <span class="comment">         *  3I  7I  bI  fI      Q7</span>
<a name="l01302"></a>01302 <span class="comment">         */</span>
<a name="l01303"></a>01303 
<a name="l01304"></a>01304         NE10_RADIX4X4C_TRANSPOSE_NEON (q2_in,q2_out);
<a name="l01305"></a>01305 
<a name="l01306"></a>01306         <span class="comment">// tw</span>
<a name="l01307"></a>01307         <span class="comment">// q2_in -&gt; q2_out</span>
<a name="l01308"></a>01308         q2_out0 = q2_in0;
<a name="l01309"></a>01309         NE10_CPX_MUL_NEON_F32(q2_out1,q2_in1,q2_tw0);
<a name="l01310"></a>01310         NE10_CPX_MUL_NEON_F32(q2_out2,q2_in2,q2_tw1);
<a name="l01311"></a>01311         NE10_CPX_MUL_NEON_F32(q2_out3,q2_in3,q2_tw2);
<a name="l01312"></a>01312 
<a name="l01313"></a>01313         <span class="comment">// butterfly</span>
<a name="l01314"></a>01314         <span class="comment">// out -&gt; in</span>
<a name="l01315"></a>01315         q2_in0.val[0] = vaddq_f32 (q2_out0.val[0], q2_out2.val[0]);
<a name="l01316"></a>01316         q2_in0.val[1] = vaddq_f32 (q2_out0.val[1], q2_out2.val[1]);
<a name="l01317"></a>01317         q2_in1.val[0] = vsubq_f32 (q2_out0.val[0], q2_out2.val[0]);
<a name="l01318"></a>01318         q2_in1.val[1] = vsubq_f32 (q2_out0.val[1], q2_out2.val[1]);
<a name="l01319"></a>01319         q2_in2.val[0] = vaddq_f32 (q2_out1.val[0], q2_out3.val[0]);
<a name="l01320"></a>01320         q2_in2.val[1] = vaddq_f32 (q2_out1.val[1], q2_out3.val[1]);
<a name="l01321"></a>01321         q2_in3.val[0] = vsubq_f32 (q2_out1.val[0], q2_out3.val[0]);
<a name="l01322"></a>01322         q2_in3.val[1] = vsubq_f32 (q2_out1.val[1], q2_out3.val[1]);
<a name="l01323"></a>01323 
<a name="l01324"></a>01324         <span class="comment">// in -&gt; out</span>
<a name="l01325"></a>01325         q2_out2.val[0] = vsubq_f32 (q2_in0.val[0], q2_in2.val[0]);
<a name="l01326"></a>01326         q2_out2.val[1] = vsubq_f32 (q2_in0.val[1], q2_in2.val[1]);
<a name="l01327"></a>01327         q2_out0.val[0] = vaddq_f32 (q2_in0.val[0], q2_in2.val[0]);
<a name="l01328"></a>01328         q2_out0.val[1] = vaddq_f32 (q2_in0.val[1], q2_in2.val[1]);
<a name="l01329"></a>01329 
<a name="l01330"></a>01330         q2_out1.val[0] = vaddq_f32 (q2_in1.val[0], q2_in3.val[1]);
<a name="l01331"></a>01331         q2_out1.val[1] = vsubq_f32 (q2_in1.val[1], q2_in3.val[0]);
<a name="l01332"></a>01332         q2_out3.val[0] = vsubq_f32 (q2_in1.val[0], q2_in3.val[1]);
<a name="l01333"></a>01333         q2_out3.val[1] = vaddq_f32 (q2_in1.val[1], q2_in3.val[0]);
<a name="l01334"></a>01334 
<a name="l01335"></a>01335         <span class="comment">// reverse -- CONJ</span>
<a name="l01336"></a>01336         NE10_REVERSE_FLOAT32X4( q2_out3.val[0] );
<a name="l01337"></a>01337         NE10_REVERSE_FLOAT32X4( q2_out3.val[1] );
<a name="l01338"></a>01338         NE10_REVERSE_FLOAT32X4( q2_out2.val[0] );
<a name="l01339"></a>01339         NE10_REVERSE_FLOAT32X4( q2_out2.val[1] );
<a name="l01340"></a>01340 
<a name="l01341"></a>01341         q2_out2.val[1] = vnegq_f32( q2_out2.val[1] );
<a name="l01342"></a>01342         q2_out3.val[1] = vnegq_f32( q2_out3.val[1] );
<a name="l01343"></a>01343 
<a name="l01344"></a>01344         <span class="comment">// store</span>
<a name="l01345"></a>01345         vst2q_f32(fout_r            , q2_out0 );
<a name="l01346"></a>01346         vst2q_f32(fout_r + (nfft&gt;&gt;1), q2_out1 );
<a name="l01347"></a>01347         fout_r += 8;
<a name="l01348"></a>01348 
<a name="l01349"></a>01349         vst2q_f32(fout_b + (nfft&gt;&gt;1), q2_out3 );
<a name="l01350"></a>01350         vst2q_f32(fout_b + nfft     , q2_out2 );
<a name="l01351"></a>01351         fout_b -= 8;
<a name="l01352"></a>01352     }
<a name="l01353"></a>01353 }
<a name="l01354"></a>01354 
<a name="l01355"></a>01355 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_first_stage_other_butterfly (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l01356"></a>01356                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l01357"></a>01357                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l01358"></a>01358                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l01359"></a>01359 {
<a name="l01360"></a>01360           ne10_float32_t *fout_r  =       ((ne10_float32_t*) dst ) + 12 + 16 ;
<a name="l01361"></a>01361     <span class="keyword">const</span> ne10_float32_t *fin_r =    (<span class="keyword">const</span> ne10_float32_t*) src + 8;
<a name="l01362"></a>01362     <span class="keyword">const</span> ne10_float32_t *fin_b =    (<span class="keyword">const</span> ne10_float32_t*) src - 14;
<a name="l01363"></a>01363     <span class="keyword">const</span> ne10_float32_t *tw     = ((<span class="keyword">const</span> ne10_float32_t*) twiddles) + 8  + 16;
<a name="l01364"></a>01364     ne10_int32_t loop_count = ((nfft&gt;&gt;2)-8)&gt;&gt;3;
<a name="l01365"></a>01365 
<a name="l01366"></a>01366     <span class="keywordflow">for</span> ( ; loop_count&gt;0; loop_count -- )
<a name="l01367"></a>01367     {
<a name="l01368"></a>01368         NE10_DECLARE_4(float32x4x2_t,q2_in);    <span class="comment">// 8Q</span>
<a name="l01369"></a>01369         NE10_DECLARE_3(float32x4x2_t,q2_tw);    <span class="comment">// 6Q</span>
<a name="l01370"></a>01370         NE10_DECLARE_4(float32x4x2_t,q2_out);   <span class="comment">// 8Q</span>
<a name="l01371"></a>01371 
<a name="l01372"></a>01372         <span class="comment">/*  INPUT</span>
<a name="l01373"></a>01373 <span class="comment">         *  0R  1R  2R  3R      Q0</span>
<a name="l01374"></a>01374 <span class="comment">         *  0I  1I  2I  3I      Q1</span>
<a name="l01375"></a>01375 <span class="comment">         *  4R  5R  6R  7R      Q2</span>
<a name="l01376"></a>01376 <span class="comment">         *  4I  5I  6I  7I      Q3</span>
<a name="l01377"></a>01377 <span class="comment">         *  8R  9R  aR  bR      Q4</span>
<a name="l01378"></a>01378 <span class="comment">         *  8I  9I  aI  bI      Q5</span>
<a name="l01379"></a>01379 <span class="comment">         *  cR  dR  eR  fR      Q6</span>
<a name="l01380"></a>01380 <span class="comment">         *  cI  dI  eI  fI      Q7</span>
<a name="l01381"></a>01381 <span class="comment">         */</span>
<a name="l01382"></a>01382 
<a name="l01383"></a>01383         q2_in0 = vld2q_f32(fin_r            );
<a name="l01384"></a>01384         q2_in1 = vld2q_f32(fin_r + (nfft&gt;&gt;1));
<a name="l01385"></a>01385         fin_r += 8;
<a name="l01386"></a>01386 
<a name="l01387"></a>01387         q2_in3 = vld2q_f32(fin_b + (nfft&gt;&gt;1));
<a name="l01388"></a>01388         q2_in2 = vld2q_f32(fin_b + nfft     );
<a name="l01389"></a>01389         fin_b -= 8;
<a name="l01390"></a>01390 
<a name="l01391"></a>01391         q2_tw0 = vld2q_f32(tw);
<a name="l01392"></a>01392         tw += 8;
<a name="l01393"></a>01393         q2_tw1 = vld2q_f32(tw);
<a name="l01394"></a>01394         tw += 8;
<a name="l01395"></a>01395         q2_tw2 = vld2q_f32(tw);
<a name="l01396"></a>01396         tw += 8;
<a name="l01397"></a>01397 
<a name="l01398"></a>01398         <span class="comment">// reverse -- CONJ</span>
<a name="l01399"></a>01399         NE10_REVERSE_FLOAT32X4( q2_in3.val[0] );
<a name="l01400"></a>01400         NE10_REVERSE_FLOAT32X4( q2_in3.val[1] );
<a name="l01401"></a>01401         NE10_REVERSE_FLOAT32X4( q2_in2.val[0] );
<a name="l01402"></a>01402         NE10_REVERSE_FLOAT32X4( q2_in2.val[1] );
<a name="l01403"></a>01403 
<a name="l01404"></a>01404         q2_in2.val[1] = vnegq_f32( q2_in2.val[1] );
<a name="l01405"></a>01405         q2_in3.val[1] = vnegq_f32( q2_in3.val[1] );
<a name="l01406"></a>01406 
<a name="l01407"></a>01407         <span class="comment">// in -&gt; out</span>
<a name="l01408"></a>01408         q2_out0.val[0] = vaddq_f32 (q2_in0.val[0], q2_in2.val[0]);
<a name="l01409"></a>01409         q2_out2.val[0] = vsubq_f32 (q2_in0.val[0], q2_in2.val[0]);
<a name="l01410"></a>01410 
<a name="l01411"></a>01411         q2_out0.val[1] = vaddq_f32 (q2_in0.val[1], q2_in2.val[1]);
<a name="l01412"></a>01412         q2_out2.val[1] = vsubq_f32 (q2_in0.val[1], q2_in2.val[1]);
<a name="l01413"></a>01413 
<a name="l01414"></a>01414         q2_out1.val[0] = vaddq_f32 (q2_in1.val[0], q2_in3.val[0]);
<a name="l01415"></a>01415         q2_out3.val[1] = vsubq_f32 (q2_in1.val[0], q2_in3.val[0]);
<a name="l01416"></a>01416 
<a name="l01417"></a>01417         q2_out1.val[1] = vaddq_f32 (q2_in3.val[1], q2_in1.val[1]);
<a name="l01418"></a>01418         q2_out3.val[0] = vsubq_f32 (q2_in3.val[1], q2_in1.val[1]);
<a name="l01419"></a>01419 
<a name="l01420"></a>01420         <span class="comment">// out -&gt; in</span>
<a name="l01421"></a>01421         q2_in0.val[0] = vaddq_f32 (q2_out0.val[0], q2_out1.val[0]);
<a name="l01422"></a>01422         q2_in2.val[0] = vsubq_f32 (q2_out0.val[0], q2_out1.val[0]);
<a name="l01423"></a>01423 
<a name="l01424"></a>01424         q2_in0.val[1] = vaddq_f32 (q2_out0.val[1], q2_out1.val[1]);
<a name="l01425"></a>01425         q2_in2.val[1] = vsubq_f32 (q2_out0.val[1], q2_out1.val[1]);
<a name="l01426"></a>01426 
<a name="l01427"></a>01427         q2_in1.val[0] = vaddq_f32 (q2_out2.val[0], q2_out3.val[0]);
<a name="l01428"></a>01428         q2_in3.val[0] = vsubq_f32 (q2_out2.val[0], q2_out3.val[0]);
<a name="l01429"></a>01429 
<a name="l01430"></a>01430         q2_in1.val[1] = vaddq_f32 (q2_out2.val[1], q2_out3.val[1]);
<a name="l01431"></a>01431         q2_in3.val[1] = vsubq_f32 (q2_out2.val[1], q2_out3.val[1]);
<a name="l01432"></a>01432 
<a name="l01433"></a>01433         <span class="comment">// tw</span>
<a name="l01434"></a>01434         <span class="comment">// q2_in -&gt; q2_out</span>
<a name="l01435"></a>01435         q2_out0 = q2_in0;
<a name="l01436"></a>01436         NE10_CPX_MUL_INV_NEON_F32(q2_out1,q2_in1,q2_tw0);
<a name="l01437"></a>01437         NE10_CPX_MUL_INV_NEON_F32(q2_out2,q2_in2,q2_tw1);
<a name="l01438"></a>01438         NE10_CPX_MUL_INV_NEON_F32(q2_out3,q2_in3,q2_tw2);
<a name="l01439"></a>01439 
<a name="l01440"></a>01440         <span class="comment">// transpose</span>
<a name="l01441"></a>01441         <span class="comment">// q2_out -&gt; q2_in</span>
<a name="l01442"></a>01442         NE10_RADIX4X4C_TRANSPOSE_NEON (q2_in,q2_out);
<a name="l01443"></a>01443 
<a name="l01444"></a>01444         <span class="comment">// store</span>
<a name="l01445"></a>01445         vst1q_f32(fout_r, q2_in0.val[0]);
<a name="l01446"></a>01446         fout_r += 4;
<a name="l01447"></a>01447         vst1q_f32(fout_r, q2_in0.val[1]);
<a name="l01448"></a>01448         fout_r += 4;
<a name="l01449"></a>01449         vst1q_f32(fout_r, q2_in1.val[0]);
<a name="l01450"></a>01450         fout_r += 4;
<a name="l01451"></a>01451         vst1q_f32(fout_r, q2_in1.val[1]);
<a name="l01452"></a>01452         fout_r += 4;
<a name="l01453"></a>01453         vst1q_f32(fout_r, q2_in2.val[0]);
<a name="l01454"></a>01454         fout_r += 4;
<a name="l01455"></a>01455         vst1q_f32(fout_r, q2_in2.val[1]);
<a name="l01456"></a>01456         fout_r += 4;
<a name="l01457"></a>01457         vst1q_f32(fout_r, q2_in3.val[0]);
<a name="l01458"></a>01458         fout_r += 4;
<a name="l01459"></a>01459         vst1q_f32(fout_r, q2_in3.val[1]);
<a name="l01460"></a>01460         fout_r += 4;
<a name="l01461"></a>01461     }
<a name="l01462"></a>01462 }
<a name="l01463"></a>01463 
<a name="l01464"></a>01464 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_r2c_with_twiddles_last_stage( <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l01465"></a>01465                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l01466"></a>01466                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l01467"></a>01467                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l01468"></a>01468 {
<a name="l01469"></a>01469     ne10_radix4_r2c_with_twiddles_last_stage_first_butterfly(dst,src,twiddles,nfft);
<a name="l01470"></a>01470 
<a name="l01471"></a>01471     <span class="keywordflow">if</span> (nfft==16)
<a name="l01472"></a>01472     {
<a name="l01473"></a>01473         <span class="keywordflow">return</span>;
<a name="l01474"></a>01474     }
<a name="l01475"></a>01475 
<a name="l01476"></a>01476     ne10_radix4_r2c_with_twiddles_last_stage_second_butterfly(dst,src,twiddles,nfft);
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <span class="keywordflow">if</span> (nfft==32)
<a name="l01479"></a>01479     {
<a name="l01480"></a>01480         <span class="keywordflow">return</span>;
<a name="l01481"></a>01481     }
<a name="l01482"></a>01482 
<a name="l01483"></a>01483     ne10_radix4_r2c_with_twiddles_last_stage_other_butterfly(dst,src,twiddles,nfft);
<a name="l01484"></a>01484 }
<a name="l01485"></a>01485 
<a name="l01486"></a>01486 NE10_INLINE <span class="keywordtype">void</span> ne10_radix4_c2r_with_twiddles_first_stage( <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *dst,
<a name="l01487"></a>01487                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *src,
<a name="l01488"></a>01488                                             <span class="keyword">const</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *twiddles,
<a name="l01489"></a>01489                                             <span class="keyword">const</span> ne10_int32_t nfft)
<a name="l01490"></a>01490 {
<a name="l01491"></a>01491     ne10_radix4_c2r_with_twiddles_first_stage_first_butterfly(dst,src,twiddles,nfft);
<a name="l01492"></a>01492 
<a name="l01493"></a>01493     <span class="keywordflow">if</span> (nfft==16)
<a name="l01494"></a>01494     {
<a name="l01495"></a>01495         <span class="keywordflow">return</span>;
<a name="l01496"></a>01496     }
<a name="l01497"></a>01497 
<a name="l01498"></a>01498     ne10_radix4_c2r_with_twiddles_first_stage_second_butterfly(dst,src,twiddles,nfft);
<a name="l01499"></a>01499 
<a name="l01500"></a>01500     <span class="keywordflow">if</span> (nfft==32)
<a name="l01501"></a>01501     {
<a name="l01502"></a>01502         <span class="keywordflow">return</span>;
<a name="l01503"></a>01503     }
<a name="l01504"></a>01504 
<a name="l01505"></a>01505     ne10_radix4_c2r_with_twiddles_first_stage_other_butterfly(dst,src,twiddles,nfft);
<a name="l01506"></a>01506 }
<a name="l01507"></a>01507 
<a name="l01523"></a><a class="code" href="group__R2C__FFT__IFFT.html#ga48dda98722214c5134a47dc600bd9c92">01523</a> <span class="keywordtype">void</span> <a class="code" href="group__R2C__FFT__IFFT.html#ga48dda98722214c5134a47dc600bd9c92" title="Mixed radix-2/4 FFT (real to complex) of float(32-bit) data.">ne10_fft_r2c_1d_float32_neon</a> (<a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fout,
<a name="l01524"></a>01524                                    ne10_float32_t *fin,
<a name="l01525"></a>01525                                    <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l01526"></a>01526 {
<a name="l01527"></a>01527     <span class="keyword">typedef</span>         ne10_float32_t REAL;
<a name="l01528"></a>01528     <span class="keyword">typedef</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> CPLX;
<a name="l01529"></a>01529 
<a name="l01530"></a>01530     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf = cfg-&gt;buffer;
<a name="l01531"></a>01531     ne10_float32_t *fout_r = (ne10_float32_t*) fout;
<a name="l01532"></a>01532 
<a name="l01533"></a>01533     <span class="keywordflow">switch</span> (cfg-&gt;nfft)
<a name="l01534"></a>01534     {
<a name="l01535"></a>01535         <span class="keywordflow">case</span> 8:
<a name="l01536"></a>01536             ne10_radix8_r2c_c ( (CPLX*) fout_r, (<span class="keyword">const</span> CPLX*) fin, 1, 1, 8);
<a name="l01537"></a>01537             fout[0].r = fout[0].i;
<a name="l01538"></a>01538             <span class="keywordflow">break</span>;
<a name="l01539"></a>01539         <span class="keywordflow">default</span>:
<a name="l01540"></a>01540             ne10_mixed_radix_r2c_butterfly_float32_neon (fout, (CPLX*) fin, cfg-&gt;r_factors_neon, cfg-&gt;r_twiddles_neon, tmpbuf);
<a name="l01541"></a>01541             ne10_radix4_r2c_with_twiddles_last_stage(fout, tmpbuf, cfg-&gt;r_super_twiddles_neon, cfg-&gt;nfft);
<a name="l01542"></a>01542             fout[cfg-&gt;nfft / 2].r = fout[0].i;
<a name="l01543"></a>01543             <span class="keywordflow">break</span>;
<a name="l01544"></a>01544     }
<a name="l01545"></a>01545     fout[0].i = fout[cfg-&gt;nfft / 2].i = 0.0f;
<a name="l01546"></a>01546 }
<a name="l01547"></a>01547 
<a name="l01558"></a><a class="code" href="group__R2C__FFT__IFFT.html#gaf3c09e5a2125de2465b52bb82ad0feec">01558</a> <span class="keywordtype">void</span> <a class="code" href="group__R2C__FFT__IFFT.html#gaf3c09e5a2125de2465b52bb82ad0feec" title="Mixed radix-2/4 IFFT (complex to real) of float(32-bit) data.">ne10_fft_c2r_1d_float32_neon</a> (ne10_float32_t *fout,
<a name="l01559"></a>01559                                    <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> *fin,
<a name="l01560"></a>01560                                    <a class="code" href="structne10__fft__r2c__state__float32__t.html">ne10_fft_r2c_cfg_float32_t</a> cfg)
<a name="l01561"></a>01561 {
<a name="l01562"></a>01562     <span class="keyword">typedef</span>         ne10_float32_t REAL;
<a name="l01563"></a>01563     <span class="keyword">typedef</span> <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> CPLX;
<a name="l01564"></a>01564 
<a name="l01565"></a>01565     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * tmpbuf = cfg-&gt;buffer;
<a name="l01566"></a>01566     <a class="code" href="structne10__fft__cpx__float32__t.html">ne10_fft_cpx_float32_t</a> * fout_c;
<a name="l01567"></a>01567     ne10_int32_t stage_count;
<a name="l01568"></a>01568     ne10_int32_t radix;
<a name="l01569"></a>01569 
<a name="l01570"></a>01570     <span class="keywordflow">switch</span> (cfg-&gt;nfft)
<a name="l01571"></a>01571     {
<a name="l01572"></a>01572         <span class="keywordflow">case</span> 8:
<a name="l01573"></a>01573             fin[0].i = fin[0].r;
<a name="l01574"></a>01574             fin[0].r = 0.0f;
<a name="l01575"></a>01575             ne10_radix8_c2r_c  ( (CPLX*) fout, (<span class="keyword">const</span> CPLX*) &amp;fin[0].i, 1, 1, 8);
<a name="l01576"></a>01576             fin[0].r = fin[0].i;
<a name="l01577"></a>01577             <span class="keywordflow">break</span>;
<a name="l01578"></a>01578         <span class="keywordflow">default</span>:
<a name="l01579"></a>01579             stage_count = cfg-&gt;r_factors_neon[0];
<a name="l01580"></a>01580             radix       = cfg-&gt;r_factors_neon[  stage_count &lt;&lt; 1 ];
<a name="l01581"></a>01581             <span class="keywordflow">if</span> (radix==2)
<a name="l01582"></a>01582             {
<a name="l01583"></a>01583                 stage_count --;
<a name="l01584"></a>01584             }
<a name="l01585"></a>01585             fin[0].i = fin[cfg-&gt;nfft&gt;&gt;1].r;
<a name="l01586"></a>01586             fout_c = (stage_count % 2==1) ? tmpbuf : (CPLX*)fout;
<a name="l01587"></a>01587             ne10_radix4_c2r_with_twiddles_first_stage( (CPLX*) fout_c, fin, cfg-&gt;r_super_twiddles_neon, cfg-&gt;nfft);
<a name="l01588"></a>01588             ne10_mixed_radix_c2r_butterfly_float32_neon ( (CPLX*) fout, (CPLX*) NULL, cfg-&gt;r_factors_neon, cfg-&gt;r_twiddles_neon_backward, tmpbuf);
<a name="l01589"></a>01589             <span class="keywordflow">break</span>;
<a name="l01590"></a>01590     }
<a name="l01591"></a>01591     fin[0].i = 0.0f;
<a name="l01592"></a>01592 }
<a name="l01593"></a>01593 
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 21 2015 18:47:14 for Project Ne10 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
